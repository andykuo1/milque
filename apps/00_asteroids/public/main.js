(()=>{var Kr=Object.create,Pt=Object.defineProperty,Zr=Object.getPrototypeOf,Yr=Object.prototype.hasOwnProperty,Qr=Object.getOwnPropertyNames,Vr=Object.getOwnPropertyDescriptor;var Jr=t=>Pt(t,"__esModule",{value:!0});var tn=(t,e)=>()=>(t&&(e=t(t=0)),e),dt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),en=(t,e)=>{for(var r in e)Pt(t,r,{get:e[r],enumerable:!0})},rn=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Qr(e))!Yr.call(t,i)&&i!=="default"&&Pt(t,i,{get:()=>e[i],enumerable:!(r=Vr(e,i))||r.enumerable});return t},nn=t=>rn(Jr(Pt(t!=null?Kr(Zr(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var je={};en(je,{basename:()=>Je,default:()=>Cn,delimiter:()=>Qe,dirname:()=>Ve,extname:()=>tr,isAbsolute:()=>le,join:()=>Ke,normalize:()=>ue,relative:()=>Ze,resolve:()=>Ut,sep:()=>Ye});function Xe(t,e){for(var r=0,i=t.length-1;i>=0;i--){var n=t[i];n==="."?t.splice(i,1):n===".."?(t.splice(i,1),r++):r&&(t.splice(i,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function Ut(){for(var t="",e=!1,r=arguments.length-1;r>=-1&&!e;r--){var i=r>=0?arguments[r]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!i)continue;t=i+"/"+t,e=i.charAt(0)==="/"}return t=Xe(ae(t.split("/"),function(n){return!!n}),!e).join("/"),(e?"/":"")+t||"."}function ue(t){var e=le(t),r=bn(t,-1)==="/";return t=Xe(ae(t.split("/"),function(i){return!!i}),!e).join("/"),!t&&!e&&(t="."),t&&r&&(t+="/"),(e?"/":"")+t}function le(t){return t.charAt(0)==="/"}function Ke(){var t=Array.prototype.slice.call(arguments,0);return ue(ae(t,function(e,r){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))}function Ze(t,e){t=Ut(t).substr(1),e=Ut(e).substr(1);function r(p){for(var v=0;v<p.length&&p[v]==="";v++);for(var m=p.length-1;m>=0&&p[m]==="";m--);return v>m?[]:p.slice(v,m-v+1)}for(var i=r(t.split("/")),n=r(e.split("/")),o=Math.min(i.length,n.length),s=o,c=0;c<o;c++)if(i[c]!==n[c]){s=c;break}for(var u=[],c=s;c<i.length;c++)u.push("..");return u=u.concat(n.slice(s)),u.join("/")}function Ve(t){var e=oe(t),r=e[0],i=e[1];return!r&&!i?".":(i&&(i=i.substr(0,i.length-1)),r+i)}function Je(t,e){var r=oe(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r}function tr(t){return oe(t)[3]}function ae(t,e){if(t.filter)return t.filter(e);for(var r=[],i=0;i<t.length;i++)e(t[i],i,t)&&r.push(t[i]);return r}var xn,oe,Ye,Qe,Cn,bn,er=tn(()=>{xn=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,oe=function(t){return xn.exec(t).slice(1)};Ye="/",Qe=":";Cn={extname:tr,basename:Je,dirname:Ve,sep:Ye,delimiter:Qe,relative:Ze,join:Ke,isAbsolute:le,normalize:ue,resolve:Ut};bn="ab".substr(-1)==="b"?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}});var Ft=dt((Ki,Bt)=>{var gt=(er(),je);gt&&gt.default?Bt.exports=gt.default:gt&&(Bt.exports=gt);if(gt)for(let t in gt)Bt.exports[t]=gt[t]});var bt=dt((Zi,rr)=>{"use strict";var Tn=Ft(),at="\\\\/",nr=`[^${at}]`,ht="\\.",On="\\+",Ln="\\?",Gt="\\/",Hn="(?=.)",ir="[^/]",he=`(?:${Gt}|$)`,sr=`(?:^|${Gt})`,ce=`${ht}{1,2}${he}`,$n=`(?!${ht})`,kn=`(?!${sr}${ce})`,Pn=`(?!${ht}{0,1}${he})`,In=`(?!${ce})`,Mn=`[^.${Gt}]`,Nn=`${ir}*?`,or={DOT_LITERAL:ht,PLUS_LITERAL:On,QMARK_LITERAL:Ln,SLASH_LITERAL:Gt,ONE_CHAR:Hn,QMARK:ir,END_ANCHOR:he,DOTS_SLASH:ce,NO_DOT:$n,NO_DOTS:kn,NO_DOT_SLASH:Pn,NO_DOTS_SLASH:In,QMARK_NO_DOT:Mn,STAR:Nn,START_ANCHOR:sr},Dn={...or,SLASH_LITERAL:`[${at}]`,QMARK:nr,STAR:`${nr}*?`,DOTS_SLASH:`${ht}{1,2}(?:[${at}]|$)`,NO_DOT:`(?!${ht})`,NO_DOTS:`(?!(?:^|[${at}])${ht}{1,2}(?:[${at}]|$))`,NO_DOT_SLASH:`(?!${ht}{0,1}(?:[${at}]|$))`,NO_DOTS_SLASH:`(?!${ht}{1,2}(?:[${at}]|$))`,QMARK_NO_DOT:`[^.${at}]`,START_ANCHOR:`(?:^|[${at}])`,END_ANCHOR:`(?:[${at}]|$)`},zn={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};rr.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:zn,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Tn.sep,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?Dn:or}}});var qt=dt(V=>{"use strict";var Un=Ft(),Bn=!1,{REGEX_BACKSLASH:Fn,REGEX_REMOVE_BACKSLASH:Gn,REGEX_SPECIAL_CHARS:qn,REGEX_SPECIAL_CHARS_GLOBAL:Wn}=bt();V.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);V.hasRegexChars=t=>qn.test(t);V.isRegexChar=t=>t.length===1&&V.hasRegexChars(t);V.escapeRegex=t=>t.replace(Wn,"\\$1");V.toPosixSlashes=t=>t.replace(Fn,"/");V.removeBackslashes=t=>t.replace(Gn,e=>e==="\\"?"":e);V.supportsLookbehinds=()=>{let t=process.version.slice(1).split(".").map(Number);return t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10};V.isWindows=t=>t&&typeof t.windows=="boolean"?t.windows:Bn===!0||Un.sep==="\\";V.escapeLast=(t,e,r)=>{let i=t.lastIndexOf(e,r);return i===-1?t:t[i-1]==="\\"?V.escapeLast(t,e,i-1):`${t.slice(0,i)}\\${t.slice(i)}`};V.removePrefix=(t,e={})=>{let r=t;return r.startsWith("./")&&(r=r.slice(2),e.prefix="./"),r};V.wrapOutput=(t,e={},r={})=>{let i=r.contains?"":"^",n=r.contains?"":"$",o=`${i}(?:${t})${n}`;return e.negated===!0&&(o=`(?:^(?!${o}).*$)`),o}});var gr=dt((Qi,ar)=>{"use strict";var lr=qt(),{CHAR_ASTERISK:fe,CHAR_AT:jn,CHAR_BACKWARD_SLASH:Ct,CHAR_COMMA:Xn,CHAR_DOT:pe,CHAR_EXCLAMATION_MARK:ge,CHAR_FORWARD_SLASH:ur,CHAR_LEFT_CURLY_BRACE:ve,CHAR_LEFT_PARENTHESES:de,CHAR_LEFT_SQUARE_BRACKET:Kn,CHAR_PLUS:Zn,CHAR_QUESTION_MARK:hr,CHAR_RIGHT_CURLY_BRACE:Yn,CHAR_RIGHT_PARENTHESES:cr,CHAR_RIGHT_SQUARE_BRACKET:Qn}=bt(),fr=t=>t===ur||t===Ct,pr=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?Infinity:1)},Vn=(t,e)=>{let r=e||{},i=t.length-1,n=r.parts===!0||r.scanToEnd===!0,o=[],s=[],c=[],u=t,p=-1,v=0,m=0,b=!1,C=!1,E=!1,x=!1,N=!1,X=!1,G=!1,T=!1,F=!1,$=!1,q=0,I,d,S={value:"",depth:0,isGlob:!1},U=()=>p>=i,h=()=>u.charCodeAt(p+1),O=()=>(I=d,u.charCodeAt(++p));for(;p<i;){d=O();let W;if(d===Ct){G=S.backslashes=!0,d=O(),d===ve&&(X=!0);continue}if(X===!0||d===ve){for(q++;U()!==!0&&(d=O());){if(d===Ct){G=S.backslashes=!0,O();continue}if(d===ve){q++;continue}if(X!==!0&&d===pe&&(d=O())===pe){if(b=S.isBrace=!0,E=S.isGlob=!0,$=!0,n===!0)continue;break}if(X!==!0&&d===Xn){if(b=S.isBrace=!0,E=S.isGlob=!0,$=!0,n===!0)continue;break}if(d===Yn&&(q--,q===0)){X=!1,b=S.isBrace=!0,$=!0;break}}if(n===!0)continue;break}if(d===ur){if(o.push(p),s.push(S),S={value:"",depth:0,isGlob:!1},$===!0)continue;if(I===pe&&p===v+1){v+=2;continue}m=p+1;continue}if(r.noext!==!0&&(d===Zn||d===jn||d===fe||d===hr||d===ge)===!0&&h()===de){if(E=S.isGlob=!0,x=S.isExtglob=!0,$=!0,d===ge&&p===v&&(F=!0),n===!0){for(;U()!==!0&&(d=O());){if(d===Ct){G=S.backslashes=!0,d=O();continue}if(d===cr){E=S.isGlob=!0,$=!0;break}}continue}break}if(d===fe){if(I===fe&&(N=S.isGlobstar=!0),E=S.isGlob=!0,$=!0,n===!0)continue;break}if(d===hr){if(E=S.isGlob=!0,$=!0,n===!0)continue;break}if(d===Kn){for(;U()!==!0&&(W=O());){if(W===Ct){G=S.backslashes=!0,O();continue}if(W===Qn){C=S.isBracket=!0,E=S.isGlob=!0,$=!0;break}}if(n===!0)continue;break}if(r.nonegate!==!0&&d===ge&&p===v){T=S.negated=!0,v++;continue}if(r.noparen!==!0&&d===de){if(E=S.isGlob=!0,n===!0){for(;U()!==!0&&(d=O());){if(d===de){G=S.backslashes=!0,d=O();continue}if(d===cr){$=!0;break}}continue}break}if(E===!0){if($=!0,n===!0)continue;break}}r.noext===!0&&(x=!1,E=!1);let R=u,J="",l="";v>0&&(J=u.slice(0,v),u=u.slice(v),m-=v),R&&E===!0&&m>0?(R=u.slice(0,m),l=u.slice(m)):E===!0?(R="",l=u):R=u,R&&R!==""&&R!=="/"&&R!==u&&fr(R.charCodeAt(R.length-1))&&(R=R.slice(0,-1)),r.unescape===!0&&(l&&(l=lr.removeBackslashes(l)),R&&G===!0&&(R=lr.removeBackslashes(R)));let a={prefix:J,input:t,start:v,base:R,glob:l,isBrace:b,isBracket:C,isGlob:E,isExtglob:x,isGlobstar:N,negated:T,negatedExtglob:F};if(r.tokens===!0&&(a.maxDepth=0,fr(d)||s.push(S),a.tokens=s),r.parts===!0||r.tokens===!0){let W;for(let _=0;_<o.length;_++){let Q=W?W+1:v,j=o[_],K=t.slice(Q,j);r.tokens&&(_===0&&v!==0?(s[_].isPrefix=!0,s[_].value=J):s[_].value=K,pr(s[_]),a.maxDepth+=s[_].depth),(_!==0||K!=="")&&c.push(K),W=j}if(W&&W+1<t.length){let _=t.slice(W+1);c.push(_),r.tokens&&(s[s.length-1].value=_,pr(s[s.length-1]),a.maxDepth+=s[s.length-1].depth)}a.slashes=o,a.parts=c}return a};ar.exports=Vn});var mr=dt((Vi,vr)=>{"use strict";var Wt=bt(),tt=qt(),{MAX_LENGTH:jt,POSIX_REGEX_SOURCE:Jn,REGEX_NON_SPECIAL_CHARS:ti,REGEX_SPECIAL_CHARS_BACKREF:ei,REPLACEMENTS:dr}=Wt,ri=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let r=`[${t.join("-")}]`;try{new RegExp(r)}catch(i){return t.map(n=>tt.escapeRegex(n)).join("..")}return r},At=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,yr=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=dr[t]||t;let r={...e},i=typeof r.maxLength=="number"?Math.min(jt,r.maxLength):jt,n=t.length;if(n>i)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${i}`);let o={type:"bos",value:"",output:r.prepend||""},s=[o],c=r.capture?"":"?:",u=tt.isWindows(e),p=Wt.globChars(u),v=Wt.extglobChars(p),{DOT_LITERAL:m,PLUS_LITERAL:b,SLASH_LITERAL:C,ONE_CHAR:E,DOTS_SLASH:x,NO_DOT:N,NO_DOT_SLASH:X,NO_DOTS_SLASH:G,QMARK:T,QMARK_NO_DOT:F,STAR:$,START_ANCHOR:q}=p,I=g=>`(${c}(?:(?!${q}${g.dot?x:m}).)*?)`,d=r.dot?"":N,S=r.dot?T:F,U=r.bash===!0?I(r):$;r.capture&&(U=`(${U})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let h={input:t,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:s};t=tt.removePrefix(t,h),n=t.length;let O=[],R=[],J=[],l=o,a,W=()=>h.index===n-1,_=h.peek=(g=1)=>t[h.index+g],Q=h.advance=()=>t[++h.index]||"",j=()=>t.slice(h.index+1),K=(g="",k=0)=>{h.consumed+=g,h.index+=k},nt=g=>{h.output+=g.output!=null?g.output:g.value,K(g.value)},St=()=>{let g=1;for(;_()==="!"&&(_(2)!=="("||_(3)==="?");)Q(),h.start++,g++;return g%2==0?!1:(h.negated=!0,h.start++,!0)},pt=g=>{h[g]++,J.push(g)},it=g=>{h[g]--,J.pop()},w=g=>{if(l.type==="globstar"){let k=h.braces>0&&(g.type==="comma"||g.type==="brace"),f=g.extglob===!0||O.length&&(g.type==="pipe"||g.type==="paren");g.type!=="slash"&&g.type!=="paren"&&!k&&!f&&(h.output=h.output.slice(0,-l.output.length),l.type="star",l.value="*",l.output=U,h.output+=l.output)}if(O.length&&g.type!=="paren"&&(O[O.length-1].inner+=g.value),(g.value||g.output)&&nt(g),l&&l.type==="text"&&g.type==="text"){l.value+=g.value,l.output=(l.output||"")+g.value;return}g.prev=l,s.push(g),l=g},vt=(g,k)=>{let f={...v[k],conditions:1,inner:""};f.prev=l,f.parens=h.parens,f.output=h.output;let A=(r.capture?"(":"")+f.open;pt("parens"),w({type:g,value:k,output:h.output?"":E}),w({type:"paren",extglob:!0,value:Q(),output:A}),O.push(f)},$t=g=>{let k=g.close+(r.capture?")":""),f;if(g.type==="negate"){let A=U;g.inner&&g.inner.length>1&&g.inner.includes("/")&&(A=I(r)),(A!==U||W()||/^\)+$/.test(j()))&&(k=g.close=`)$))${A}`),g.inner.includes("*")&&(f=j())&&/^\.[^\\/.]+$/.test(f)&&(k=g.close=`)${f})${A})`),g.prev.type==="bos"&&(h.negatedExtglob=!0)}w({type:"paren",extglob:!0,value:a,output:k}),it("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let g=!1,k=t.replace(ei,(f,A,D,Y,B,Vt)=>Y==="\\"?(g=!0,f):Y==="?"?A?A+Y+(B?T.repeat(B.length):""):Vt===0?S+(B?T.repeat(B.length):""):T.repeat(D.length):Y==="."?m.repeat(D.length):Y==="*"?A?A+Y+(B?U:""):U:A?f:`\\${f}`);return g===!0&&(r.unescape===!0?k=k.replace(/\\/g,""):k=k.replace(/\\+/g,f=>f.length%2==0?"\\\\":f?"\\":"")),k===t&&r.contains===!0?(h.output=t,h):(h.output=tt.wrapOutput(k,h,e),h)}for(;!W();){if(a=Q(),a==="\0")continue;if(a==="\\"){let f=_();if(f==="/"&&r.bash!==!0||f==="."||f===";")continue;if(!f){a+="\\",w({type:"text",value:a});continue}let A=/^\\+/.exec(j()),D=0;if(A&&A[0].length>2&&(D=A[0].length,h.index+=D,D%2!=0&&(a+="\\")),r.unescape===!0?a=Q():a+=Q(),h.brackets===0){w({type:"text",value:a});continue}}if(h.brackets>0&&(a!=="]"||l.value==="["||l.value==="[^")){if(r.posix!==!1&&a===":"){let f=l.value.slice(1);if(f.includes("[")&&(l.posix=!0,f.includes(":"))){let A=l.value.lastIndexOf("["),D=l.value.slice(0,A),Y=l.value.slice(A+2),B=Jn[Y];if(B){l.value=D+B,h.backtrack=!0,Q(),!o.output&&s.indexOf(l)===1&&(o.output=E);continue}}}(a==="["&&_()!==":"||a==="-"&&_()==="]")&&(a=`\\${a}`),a==="]"&&(l.value==="["||l.value==="[^")&&(a=`\\${a}`),r.posix===!0&&a==="!"&&l.value==="["&&(a="^"),l.value+=a,nt({value:a});continue}if(h.quotes===1&&a!=='"'){a=tt.escapeRegex(a),l.value+=a,nt({value:a});continue}if(a==='"'){h.quotes=h.quotes===1?0:1,r.keepQuotes===!0&&w({type:"text",value:a});continue}if(a==="("){pt("parens"),w({type:"paren",value:a});continue}if(a===")"){if(h.parens===0&&r.strictBrackets===!0)throw new SyntaxError(At("opening","("));let f=O[O.length-1];if(f&&h.parens===f.parens+1){$t(O.pop());continue}w({type:"paren",value:a,output:h.parens?")":"\\)"}),it("parens");continue}if(a==="["){if(r.nobracket===!0||!j().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(At("closing","]"));a=`\\${a}`}else pt("brackets");w({type:"bracket",value:a});continue}if(a==="]"){if(r.nobracket===!0||l&&l.type==="bracket"&&l.value.length===1){w({type:"text",value:a,output:`\\${a}`});continue}if(h.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(At("opening","["));w({type:"text",value:a,output:`\\${a}`});continue}it("brackets");let f=l.value.slice(1);if(l.posix!==!0&&f[0]==="^"&&!f.includes("/")&&(a=`/${a}`),l.value+=a,nt({value:a}),r.literalBrackets===!1||tt.hasRegexChars(f))continue;let A=tt.escapeRegex(l.value);if(h.output=h.output.slice(0,-l.value.length),r.literalBrackets===!0){h.output+=A,l.value=A;continue}l.value=`(${c}${A}|${l.value})`,h.output+=l.value;continue}if(a==="{"&&r.nobrace!==!0){pt("braces");let f={type:"brace",value:a,output:"(",outputIndex:h.output.length,tokensIndex:h.tokens.length};R.push(f),w(f);continue}if(a==="}"){let f=R[R.length-1];if(r.nobrace===!0||!f){w({type:"text",value:a,output:a});continue}let A=")";if(f.dots===!0){let D=s.slice(),Y=[];for(let B=D.length-1;B>=0&&(s.pop(),D[B].type!=="brace");B--)D[B].type!=="dots"&&Y.unshift(D[B].value);A=ri(Y,r),h.backtrack=!0}if(f.comma!==!0&&f.dots!==!0){let D=h.output.slice(0,f.outputIndex),Y=h.tokens.slice(f.tokensIndex);f.value=f.output="\\{",a=A="\\}",h.output=D;for(let B of Y)h.output+=B.output||B.value}w({type:"brace",value:a,output:A}),it("braces"),R.pop();continue}if(a==="|"){O.length>0&&O[O.length-1].conditions++,w({type:"text",value:a});continue}if(a===","){let f=a,A=R[R.length-1];A&&J[J.length-1]==="braces"&&(A.comma=!0,f="|"),w({type:"comma",value:a,output:f});continue}if(a==="/"){if(l.type==="dot"&&h.index===h.start+1){h.start=h.index+1,h.consumed="",h.output="",s.pop(),l=o;continue}w({type:"slash",value:a,output:C});continue}if(a==="."){if(h.braces>0&&l.type==="dot"){l.value==="."&&(l.output=m);let f=R[R.length-1];l.type="dots",l.output+=a,l.value+=a,f.dots=!0;continue}if(h.braces+h.parens===0&&l.type!=="bos"&&l.type!=="slash"){w({type:"text",value:a,output:m});continue}w({type:"dot",value:a,output:m});continue}if(a==="?"){if(!(l&&l.value==="(")&&r.noextglob!==!0&&_()==="("&&_(2)!=="?"){vt("qmark",a);continue}if(l&&l.type==="paren"){let A=_(),D=a;if(A==="<"&&!tt.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(l.value==="("&&!/[!=<:]/.test(A)||A==="<"&&!/<([!=]|\w+>)/.test(j()))&&(D=`\\${a}`),w({type:"text",value:a,output:D});continue}if(r.dot!==!0&&(l.type==="slash"||l.type==="bos")){w({type:"qmark",value:a,output:F});continue}w({type:"qmark",value:a,output:T});continue}if(a==="!"){if(r.noextglob!==!0&&_()==="("&&(_(2)!=="?"||!/[!=<:]/.test(_(3)))){vt("negate",a);continue}if(r.nonegate!==!0&&h.index===0){St();continue}}if(a==="+"){if(r.noextglob!==!0&&_()==="("&&_(2)!=="?"){vt("plus",a);continue}if(l&&l.value==="("||r.regex===!1){w({type:"plus",value:a,output:b});continue}if(l&&(l.type==="bracket"||l.type==="paren"||l.type==="brace")||h.parens>0){w({type:"plus",value:a});continue}w({type:"plus",value:b});continue}if(a==="@"){if(r.noextglob!==!0&&_()==="("&&_(2)!=="?"){w({type:"at",extglob:!0,value:a,output:""});continue}w({type:"text",value:a});continue}if(a!=="*"){(a==="$"||a==="^")&&(a=`\\${a}`);let f=ti.exec(j());f&&(a+=f[0],h.index+=f[0].length),w({type:"text",value:a});continue}if(l&&(l.type==="globstar"||l.star===!0)){l.type="star",l.star=!0,l.value+=a,l.output=U,h.backtrack=!0,h.globstar=!0,K(a);continue}let g=j();if(r.noextglob!==!0&&/^\([^?]/.test(g)){vt("star",a);continue}if(l.type==="star"){if(r.noglobstar===!0){K(a);continue}let f=l.prev,A=f.prev,D=f.type==="slash"||f.type==="bos",Y=A&&(A.type==="star"||A.type==="globstar");if(r.bash===!0&&(!D||g[0]&&g[0]!=="/")){w({type:"star",value:a,output:""});continue}let B=h.braces>0&&(f.type==="comma"||f.type==="brace"),Vt=O.length&&(f.type==="pipe"||f.type==="paren");if(!D&&f.type!=="paren"&&!B&&!Vt){w({type:"star",value:a,output:""});continue}for(;g.slice(0,3)==="/**";){let kt=t[h.index+4];if(kt&&kt!=="/")break;g=g.slice(3),K("/**",3)}if(f.type==="bos"&&W()){l.type="globstar",l.value+=a,l.output=I(r),h.output=l.output,h.globstar=!0,K(a);continue}if(f.type==="slash"&&f.prev.type!=="bos"&&!Y&&W()){h.output=h.output.slice(0,-(f.output+l.output).length),f.output=`(?:${f.output}`,l.type="globstar",l.output=I(r)+(r.strictSlashes?")":"|$)"),l.value+=a,h.globstar=!0,h.output+=f.output+l.output,K(a);continue}if(f.type==="slash"&&f.prev.type!=="bos"&&g[0]==="/"){let kt=g[1]!==void 0?"|$":"";h.output=h.output.slice(0,-(f.output+l.output).length),f.output=`(?:${f.output}`,l.type="globstar",l.output=`${I(r)}${C}|${C}${kt})`,l.value+=a,h.output+=f.output+l.output,h.globstar=!0,K(a+Q()),w({type:"slash",value:"/",output:""});continue}if(f.type==="bos"&&g[0]==="/"){l.type="globstar",l.value+=a,l.output=`(?:^|${C}|${I(r)}${C})`,h.output=l.output,h.globstar=!0,K(a+Q()),w({type:"slash",value:"/",output:""});continue}h.output=h.output.slice(0,-l.output.length),l.type="globstar",l.output=I(r),l.value+=a,h.output+=l.output,h.globstar=!0,K(a);continue}let k={type:"star",value:a,output:U};if(r.bash===!0){k.output=".*?",(l.type==="bos"||l.type==="slash")&&(k.output=d+k.output),w(k);continue}if(l&&(l.type==="bracket"||l.type==="paren")&&r.regex===!0){k.output=a,w(k);continue}(h.index===h.start||l.type==="slash"||l.type==="dot")&&(l.type==="dot"?(h.output+=X,l.output+=X):r.dot===!0?(h.output+=G,l.output+=G):(h.output+=d,l.output+=d),_()!=="*"&&(h.output+=E,l.output+=E)),w(k)}for(;h.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(At("closing","]"));h.output=tt.escapeLast(h.output,"["),it("brackets")}for(;h.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(At("closing",")"));h.output=tt.escapeLast(h.output,"("),it("parens")}for(;h.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(At("closing","}"));h.output=tt.escapeLast(h.output,"{"),it("braces")}if(r.strictSlashes!==!0&&(l.type==="star"||l.type==="bracket")&&w({type:"maybe_slash",value:"",output:`${C}?`}),h.backtrack===!0){h.output="";for(let g of h.tokens)h.output+=g.output!=null?g.output:g.value,g.suffix&&(h.output+=g.suffix)}return h};yr.fastpaths=(t,e)=>{let r={...e},i=typeof r.maxLength=="number"?Math.min(jt,r.maxLength):jt,n=t.length;if(n>i)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${i}`);t=dr[t]||t;let o=tt.isWindows(e),{DOT_LITERAL:s,SLASH_LITERAL:c,ONE_CHAR:u,DOTS_SLASH:p,NO_DOT:v,NO_DOTS:m,NO_DOTS_SLASH:b,STAR:C,START_ANCHOR:E}=Wt.globChars(o),x=r.dot?m:v,N=r.dot?b:v,X=r.capture?"":"?:",G={negated:!1,prefix:""},T=r.bash===!0?".*?":C;r.capture&&(T=`(${T})`);let F=d=>d.noglobstar===!0?T:`(${X}(?:(?!${E}${d.dot?p:s}).)*?)`,$=d=>{switch(d){case"*":return`${x}${u}${T}`;case".*":return`${s}${u}${T}`;case"*.*":return`${x}${T}${s}${u}${T}`;case"*/*":return`${x}${T}${c}${u}${N}${T}`;case"**":return x+F(r);case"**/*":return`(?:${x}${F(r)}${c})?${N}${u}${T}`;case"**/*.*":return`(?:${x}${F(r)}${c})?${N}${T}${s}${u}${T}`;case"**/.*":return`(?:${x}${F(r)}${c})?${s}${u}${T}`;default:{let S=/^(.*?)\.(\w+)$/.exec(d);if(!S)return;let U=$(S[1]);return U?U+s+S[2]:void 0}}},q=tt.removePrefix(t,G),I=$(q);return I&&r.strictSlashes!==!0&&(I+=`${c}?`),I};vr.exports=yr});var Ar=dt((Ji,wr)=>{"use strict";var ni=Ft(),ii=gr(),ye=mr(),me=qt(),si=bt(),oi=t=>t&&typeof t=="object"&&!Array.isArray(t),z=(t,e,r=!1)=>{if(Array.isArray(t)){let v=t.map(b=>z(b,e,r));return b=>{for(let C of v){let E=C(b);if(E)return E}return!1}}let i=oi(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!i)throw new TypeError("Expected pattern to be a non-empty string");let n=e||{},o=me.isWindows(e),s=i?z.compileRe(t,e):z.makeRe(t,e,!1,!0),c=s.state;delete s.state;let u=()=>!1;if(n.ignore){let v={...e,ignore:null,onMatch:null,onResult:null};u=z(n.ignore,v,r)}let p=(v,m=!1)=>{let{isMatch:b,match:C,output:E}=z.test(v,s,e,{glob:t,posix:o}),x={glob:t,state:c,regex:s,posix:o,input:v,output:E,match:C,isMatch:b};return typeof n.onResult=="function"&&n.onResult(x),b===!1?(x.isMatch=!1,m?x:!1):u(v)?(typeof n.onIgnore=="function"&&n.onIgnore(x),x.isMatch=!1,m?x:!1):(typeof n.onMatch=="function"&&n.onMatch(x),m?x:!0)};return r&&(p.state=c),p};z.test=(t,e,r,{glob:i,posix:n}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let o=r||{},s=o.format||(n?me.toPosixSlashes:null),c=t===i,u=c&&s?s(t):t;return c===!1&&(u=s?s(t):t,c=u===i),(c===!1||o.capture===!0)&&(o.matchBase===!0||o.basename===!0?c=z.matchBase(t,e,r,n):c=e.exec(u)),{isMatch:Boolean(c),match:c,output:u}};z.matchBase=(t,e,r,i=me.isWindows(r))=>(e instanceof RegExp?e:z.makeRe(e,r)).test(ni.basename(t));z.isMatch=(t,e,r)=>z(e,r)(t);z.parse=(t,e)=>Array.isArray(t)?t.map(r=>z.parse(r,e)):ye(t,{...e,fastpaths:!1});z.scan=(t,e)=>ii(t,e);z.compileRe=(t,e,r=!1,i=!1)=>{if(r===!0)return t.output;let n=e||{},o=n.contains?"":"^",s=n.contains?"":"$",c=`${o}(?:${t.output})${s}`;t&&t.negated===!0&&(c=`^(?!${c}).*$`);let u=z.toRegex(c,e);return i===!0&&(u.state=t),u};z.makeRe=(t,e={},r=!1,i=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let n={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(n.output=ye.fastpaths(t,e)),n.output||(n=ye(t,e)),z.compileRe(n,e,r,i)};z.toRegex=(t,e)=>{try{let r=e||{};return new RegExp(t,r.flags||(r.nocase?"i":""))}catch(r){if(e&&e.debug===!0)throw r;return/$^/}};z.constants=si;wr.exports=z});var Er=dt((ts,_r)=>{"use strict";_r.exports=Ar()});var sn=`<div class="container">
    <label class="hidden" id="title">display-port</label>
    <label class="hidden" id="fps">00</label>
    <label class="hidden" id="dimension">0x0</label>
    <div class="content">
        <canvas>
            Oh no! Your browser does not support canvas.
        </canvas>
        <slot id="inner"></slot>
    </div>
    <slot name="frame"></slot>
</div>`,on=`:host {
    display: inline-block;
    color: #555555;
}

.container {
    display: flex;
    position: relative;
    width: 100%;
    height: 100%;
}

.content {
    position: relative;
    margin: auto;
}

.content > * {
    width: 100%;
    height: 100%;
}

canvas {
    background: #000000;
    image-rendering: pixelated;
}

label {
    position: absolute;
    font-family: monospace;
    color: currentColor;
}

#inner {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
}

#title {
    left: 0.5rem;
    top: 0.5rem;
}

#fps {
    right: 0.5rem;
    top: 0.5rem;
}

#dimension {
    left: 0.5rem;
    bottom: 0.5rem;
}

.hidden {
    display: none;
}

:host([debug]) .container {
    outline: 6px dashed rgba(0, 0, 0, 0.1);
    outline-offset: -4px;
    background-color: rgba(0, 0, 0, 0.1);
}

:host([mode="noscale"]) canvas {
    margin: 0;
    top: 0;
    left: 0;
}

:host([mode="fit"]),
:host([mode="scale"]),
:host([mode="center"]),
:host([mode="stretch"]),
:host([mode="fill"]) {
    width: 100%;
    height: 100%;
}

:host([full]) {
    width: 100vw !important;
    height: 100vh !important;
}

:host([disabled]) {
    display: none;
}

slot {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
}

::slotted(*) {
    pointer-events: auto;
}
`,be="noscale",Jt="fit",Ce="scale",Te="fill",Oe="stretch",an=300,ln=150,un=Jt,Le=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=sn,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=on,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("display-port",this)}static get observedAttributes(){return["debug","disabled","width","height","onframe","id","class"]}get mode(){return this.getAttribute("mode")}set mode(e){this.setAttribute("mode",e)}get debug(){return this._debug}set debug(e){this.toggleAttribute("debug",e)}get disabled(){return this._disabled}set disabled(e){this.toggleAttribute("disabled",e)}get width(){return this._width}set width(e){this.setAttribute("width",String(e))}get height(){return this._height}set height(e){this.setAttribute("height",String(e))}get onframe(){return this._onframe}set onframe(e){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=e,this._onframe&&this.addEventListener("frame",e)}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._canvasElement=this.shadowRoot.querySelector("canvas"),this._contentElement=this.shadowRoot.querySelector(".content"),this._innerElement=this.shadowRoot.querySelector("#inner"),this._titleElement=this.shadowRoot.querySelector("#title"),this._fpsElement=this.shadowRoot.querySelector("#fps"),this._dimensionElement=this.shadowRoot.querySelector("#dimension"),this._debug=!1,this._disabled=!1,this._width=an,this._height=ln,this._onframe=void 0,this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this.update=this.update.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){mt(this,"mode"),mt(this,"debug"),mt(this,"disabled"),mt(this,"width"),mt(this,"height"),mt(this,"onframe"),this.hasAttribute("mode")||this.setAttribute("mode",un),this.hasAttribute("tabindex")||this.setAttribute("tabindex","0"),this.updateCanvasSize(),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(e,r,i){switch(e){case"debug":this._debug=i!==null;break;case"disabled":this._disabled=i!==null;break;case"width":this._width=Number(i);break;case"height":this._height=Number(i);break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+i+"}}").bind(this);break}switch(e){case"disabled":i?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",i),this._fpsElement.classList.toggle("hidden",i),this._dimensionElement.classList.toggle("hidden",i);break}}getContext(e="2d",r=void 0){return this._canvasElement.getContext(e,r)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize();let r=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this._debug){let i=r<=0?"--":String(Math.round(1e3/r)).padStart(2,"0");if(this._fpsElement.textContent!==i&&(this._fpsElement.textContent=i),this.mode===be){let o=`${this._width}x${this._height}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}else{let o=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.textContent!==o&&(this._dimensionElement.textContent=o)}}this.dispatchEvent(new CustomEvent("frame",{detail:{now:e,prevTime:this._prevAnimationFrameTime,deltaTime:r,canvas:this._canvasElement},bubbles:!1,composed:!0}))}updateCanvasSize(){let e=this.shadowRoot.host.getBoundingClientRect(),r=e.width,i=e.height,n=this._canvasElement,o=this._width,s=this._height,c=this.mode;if(c===Oe||c===Te)o=r,s=i;else if(c!==be&&(r<o||i<s||c===Jt||c==Ce)){let p=r/o,v=i/s;p<v?(o=r,s=s*p):(o=o*v,s=i)}o=Math.floor(o),s=Math.floor(s);let u=Math.min(o/this._width,s/this._height)*.5;if(this._innerElement.style.fontSize=`font-size: ${u}em`,n.clientWidth!==o||n.clientHeight!==s){c===Ce||c===Oe?(n.width=this._width,n.height=this._height):(n.width=o,n.height=s);let p=this._contentElement.style;p.width=`${o}px`,p.height=`${s}px`,(c===Jt||c===Te)&&(this._width=o,this._height=s),this.dispatchEvent(new CustomEvent("resize",{detail:{width:o,height:s},bubbles:!1,composed:!0}))}}};Le.define();function mt(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let r=t[e];delete t[e],t[e]=r}}var He={},hn=function(t,e,r,i,n){var o=new Worker(He[e]||(He[e]=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))));return o.onerror=function(s){return n(s.error,null)},o.onmessage=function(s){return n(null,s.data)},o.postMessage(r,i),o},Z=Uint8Array,st=Uint16Array,Rt=Uint32Array,te=new Z([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ee=new Z([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$e=new Z([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ke=function(t,e){for(var r=new st(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];for(var n=new Rt(r[30]),i=1;i<30;++i)for(var o=r[i];o<r[i+1];++o)n[o]=o-r[i]<<5|i;return[r,n]},Pe=ke(te,2),re=Pe[0],cn=Pe[1];re[28]=258,cn[258]=28;var Ie=ke(ee,0),Me=Ie[0],ji=Ie[1],It=new st(32768);for(var P=0;P<32768;++P)ut=(P&43690)>>>1|(P&21845)<<1,ut=(ut&52428)>>>2|(ut&13107)<<2,ut=(ut&61680)>>>4|(ut&3855)<<4,It[P]=((ut&65280)>>>8|(ut&255)<<8)>>>1;var ut,wt=function(t,e,r){for(var i=t.length,n=0,o=new st(e);n<i;++n)++o[t[n]-1];var s=new st(e);for(n=0;n<e;++n)s[n]=s[n-1]+o[n-1]<<1;var c;if(r){c=new st(1<<e);var u=15-e;for(n=0;n<i;++n)if(t[n])for(var p=n<<4|t[n],v=e-t[n],m=s[t[n]-1]++<<v,b=m|(1<<v)-1;m<=b;++m)c[It[m]>>>u]=p}else for(c=new st(i),n=0;n<i;++n)t[n]&&(c[n]=It[s[t[n]-1]++]>>>15-t[n]);return c},xt=new Z(288);for(var P=0;P<144;++P)xt[P]=8;for(var P=144;P<256;++P)xt[P]=9;for(var P=256;P<280;++P)xt[P]=7;for(var P=280;P<288;++P)xt[P]=8;var Ne=new Z(32);for(var P=0;P<32;++P)Ne[P]=5;var De=wt(xt,9,1);var ze=wt(Ne,5,1),Mt=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},et=function(t,e,r){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&r},Nt=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Ue=function(t){return(t/8|0)+(t&7&&1)},Dt=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var i=new(t instanceof st?st:t instanceof Rt?Rt:Z)(r-e);return i.set(t.subarray(e,r)),i},Be=function(t,e,r){var i=t.length;if(!i||r&&!r.l&&i<5)return e||new Z(0);var n=!e||r,o=!r||r.i;r||(r={}),e||(e=new Z(i*3));var s=function(w){var vt=e.length;if(w>vt){var $t=new Z(Math.max(vt*2,w));$t.set(e),e=$t}},c=r.f||0,u=r.p||0,p=r.b||0,v=r.l,m=r.d,b=r.m,C=r.n,E=i*8;do{if(!v){r.f=c=et(t,u,1);var x=et(t,u+1,3);if(u+=3,x)if(x==1)v=De,m=ze,b=9,C=5;else if(x==2){var T=et(t,u,31)+257,F=et(t,u+10,15)+4,$=T+et(t,u+5,31)+1;u+=14;for(var q=new Z($),I=new Z(19),d=0;d<F;++d)I[$e[d]]=et(t,u+d*3,7);u+=F*3;for(var S=Mt(I),U=(1<<S)-1,h=wt(I,S,1),d=0;d<$;){var O=h[et(t,u,U)];u+=O&15;var N=O>>>4;if(N<16)q[d++]=N;else{var R=0,J=0;for(N==16?(J=3+et(t,u,3),u+=2,R=q[d-1]):N==17?(J=3+et(t,u,7),u+=3):N==18&&(J=11+et(t,u,127),u+=7);J--;)q[d++]=R}}var l=q.subarray(0,T),a=q.subarray(T);b=Mt(l),C=Mt(a),v=wt(l,b,1),m=wt(a,C,1)}else throw"invalid block type";else{var N=Ue(u)+4,X=t[N-4]|t[N-3]<<8,G=N+X;if(G>i){if(o)throw"unexpected EOF";break}n&&s(p+X),e.set(t.subarray(N,G),p),r.b=p+=X,r.p=u=G*8;continue}if(u>E){if(o)throw"unexpected EOF";break}}n&&s(p+131072);for(var W=(1<<b)-1,_=(1<<C)-1,Q=u;;Q=u){var R=v[Nt(t,u)&W],j=R>>>4;if(u+=R&15,u>E){if(o)throw"unexpected EOF";break}if(!R)throw"invalid length/literal";if(j<256)e[p++]=j;else if(j==256){Q=u,v=null;break}else{var K=j-254;if(j>264){var d=j-257,nt=te[d];K=et(t,u,(1<<nt)-1)+re[d],u+=nt}var St=m[Nt(t,u)&_],pt=St>>>4;if(!St)throw"invalid distance";u+=St&15;var a=Me[pt];if(pt>3){var nt=ee[pt];a+=Nt(t,u)&(1<<nt)-1,u+=nt}if(u>E){if(o)throw"unexpected EOF";break}n&&s(p+131072);for(var it=p+K;p<it;p+=4)e[p]=e[p-a],e[p+1]=e[p+1-a],e[p+2]=e[p+2-a],e[p+3]=e[p+3-a];p=it}}r.l=v,r.p=Q,r.b=p,v&&(c=1,r.m=b,r.d=m,r.n=C)}while(!c);return p==e.length?e:Dt(e,0,p)};var fn=new Z(0);var pn=function(t,e){var r={};for(var i in t)r[i]=t[i];for(var i in e)r[i]=e[i];return r},Fe=function(t,e,r){for(var i=t(),n=t.toString(),o=n.slice(n.indexOf("[")+1,n.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<i.length;++s){var c=i[s],u=o[s];if(typeof c=="function"){e+=";"+u+"=";var p=c.toString();if(c.prototype)if(p.indexOf("[native code]")!=-1){var v=p.indexOf(" ",8)+1;e+=p.slice(v,p.indexOf("(",v))}else{e+=p;for(var m in c.prototype)e+=";"+u+".prototype."+m+"="+c.prototype[m].toString()}else e+=p}else r[u]=c}return[e,r]},zt=[],gn=function(t){var e=[];for(var r in t)(t[r]instanceof Z||t[r]instanceof st||t[r]instanceof Rt)&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e},vn=function(t,e,r,i){var n;if(!zt[r]){for(var o="",s={},c=t.length-1,u=0;u<c;++u)n=Fe(t[u],o,s),o=n[0],s=n[1];zt[r]=Fe(t[c],o,s)}var p=pn({},zt[r][1]);return hn(zt[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,p,gn(p),i)},dn=function(){return[Z,st,Rt,te,ee,$e,re,Me,De,ze,It,wt,Mt,et,Nt,Ue,Dt,Be,ne,Ge,qe]};var Ge=function(t){return postMessage(t,[t.buffer])},qe=function(t){return t&&t.size&&new Z(t.size)},yn=function(t,e,r,i,n,o){var s=vn(r,i,n,function(c,u){s.terminate(),o(c,u)});return s.postMessage([t,e],e.consume?[t.buffer]:[]),function(){s.terminate()}};var ot=function(t,e){return t[e]|t[e+1]<<8},rt=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},ie=function(t,e){return rt(t,e)+rt(t,e+4)*4294967296};function mn(t,e,r){if(r||(r=e,e={}),typeof r!="function")throw"no callback";return yn(t,e,[dn],function(i){return Ge(ne(i.data[0],qe(i.data[1])))},1,r)}function ne(t,e){return Be(t,e)}var Xi=typeof TextEncoder!="undefined"&&new TextEncoder,se=typeof TextDecoder!="undefined"&&new TextDecoder,wn=0;try{se.decode(fn,{stream:!0}),wn=1}catch(t){}var An=function(t){for(var e="",r=0;;){var i=t[r++],n=(i>127)+(i>223)+(i>239);if(r+n>t.length)return[e,Dt(t,r-1)];n?n==3?(i=((i&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|i>>10,56320|i&1023)):n&1?e+=String.fromCharCode((i&31)<<6|t[r++]&63):e+=String.fromCharCode((i&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(i)}};function _n(t,e){if(e){for(var r="",i=0;i<t.length;i+=16384)r+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return r}else{if(se)return se.decode(t);var n=An(t),o=n[0],s=n[1];if(s.length)throw"invalid utf-8 data";return o}}var En=function(t,e){return e+30+ot(t,e+26)+ot(t,e+28)},Rn=function(t,e,r){var i=ot(t,e+28),n=_n(t.subarray(e+46,e+46+i),!(ot(t,e+8)&2048)),o=e+46+i,s=rt(t,e+20),c=r&&s==4294967295?Sn(t,o):[s,rt(t,e+24),rt(t,e+42)],u=c[0],p=c[1],v=c[2];return[ot(t,e+10),u,p,n,o+ot(t,e+30)+ot(t,e+32),v]},Sn=function(t,e){for(;ot(t,e)!=1;e+=4+ot(t,e+2));return[ie(t,e+12),ie(t,e+4),ie(t,e+20)]};function We(t,e){if(typeof e!="function")throw"no callback";for(var r=[],i=function(){for(var b=0;b<r.length;++b)r[b]()},n={},o=t.length-22;rt(t,o)!=101010256;--o)if(!o||t.length-o>65558){e("invalid zip file",null);return}var s=ot(t,o+8);s||e(null,{});var c=s,u=rt(t,o+16),p=u==4294967295;if(p){if(o=rt(t,o-12),rt(t,o)!=101075792){e("invalid zip file",null);return}c=s=rt(t,o+32),u=rt(t,o+48)}for(var v=function(b){var C=Rn(t,u,p),E=C[0],x=C[1],N=C[2],X=C[3],G=C[4],T=C[5],F=En(t,T);u=G;var $=function(I,d){I?(i(),e(I,null)):(n[X]=d,--s||e(null,n))};if(!E)$(null,Dt(t,F,F+x));else if(E==8){var q=t.subarray(F,F+x);if(x<32e4)try{$(null,ne(q,new Z(N)))}catch(I){$(I,null)}else r.push(mn(q,{size:N},$))}else $("unknown compression type "+E,null)},m=0;m<c;++m)v(m);return i}var Sr=nn(Er()),Rr=class{constructor(){this._buffers={}}clear(){this._buffers={}}put(e,r){this._buffers[e]=r}get(e){return this._buffers[e]}keys(){return Object.keys(this._buffers)}},ai="",li="",ui=5e3,Xt=class extends HTMLElement{static get[Symbol.for("templateNode")](){let e=document.createElement("template");return e.innerHTML=ai,Object.defineProperty(this,Symbol.for("templateNode"),{value:e}),e}static get[Symbol.for("styleNode")](){let e=document.createElement("style");return e.innerHTML=li,Object.defineProperty(this,Symbol.for("styleNode"),{value:e}),e}static define(e=window.customElements){e.define("asset-pack",Xt)}static get observedAttributes(){return["src"]}set src(e){this.setAttribute("src",e)}get src(){return this._src}constructor(){super();this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("templateNode")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("styleNode")].cloneNode(!0)),this._src="",this._files=new Rr,this._cache={},this._loading={},this._pipeline={},this.onLoad=this.onLoad.bind(this)}get files(){return this._files}async pipe(e,r){let i;if(typeof e=="string")i=e,i in this._pipeline||(e=(0,Sr.makeRe)(e));else if(e instanceof RegExp)i=e.source;else throw new Error("Filter must be either a RegExp or glob string.");let n;i in this._pipeline?n=this._pipeline[i]:(n=new xr(e),this._pipeline[i]=n),n.addHandler(r),await Promise.all(Object.entries(this._cache).map(([o,s])=>n.matches(o)?r(s,o):null))}async cache(e,r,i={}){let{ephemeral:n}=i,o=this._cache[e],s=this._loading[e];this._cache[e]=r,await Promise.all(Object.values(this._pipeline).map(c=>c.matches(e)?c.process(e,r):null)),s&&(s.resolve(r),delete this._loading[r]),n&&this._cache[r]===r&&(o?this._cache[r]=o:delete this._cache[r])}async loadAsset(e,r=ui){let i=this._cache[e];if(i)return i;if(e in this._loading)return this._loading[e].promise;{let n=new br(r);return this._loading[e]=n,n.promise}}clearAssets(){for(let e of Object.values(this._loading))e.reject(new Error("Stop loading to clear all assets."));this._loading={},this._cache={}}deleteAsset(e){e in this._loading&&(this._loading[e].reject(new Error("Stop loading to delete asset.")),delete this._loading[e]),e in this._cache&&delete this._cache[e]}getAsset(e){return this._cache[e]}hasAsset(e){let r=this._cache[e];return r||!1}connectedCallback(){hi(this,"src")}attributeChangedCallback(e,r,i){switch(e){case"src":this._src=i,i&&fetch(i).then(this.onLoad).catch(n=>console.error(`Failed to load asset pack: ${n}`));break}}async onLoad(e){let r=await e.arrayBuffer();await new Promise((i,n)=>{We(new Uint8Array(r),(o,s)=>{if(o)n(o);else{let c=this._files;Promise.all(Object.entries(s).map(([u,p])=>(c.put(u,p),this.cache(u,p)))).then(()=>i()).catch(n)}})}),this.dispatchEvent(new CustomEvent("load",{composed:!0}))}};Xt.define();function hi(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let r=t[e];delete t[e],t[e]=r}}var xr=class{constructor(e){this.filter=e,this.handlers=[]}matches(e){return this.filter.test(e)}async process(e,r){return Promise.all(this.handlers.map(i=>i(e,r)))}addHandler(e){this.handlers.push(e)}},br=class{constructor(e){this._resolve=null,this._reject=null,this._reason=null,this._value=null,this._timeoutHandle=e>0?setTimeout(()=>{this.reject(`Asset loading exceeded timeout of ${e} ms.`)},e):null,this._promise=new Promise((r,i)=>{this._value?r(this._value):this._resolve=r,this._reason?i(this._reason):this._reject=i})}get promise(){return this._promise}resolve(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._resolve?this._resolve(e):this._value=e}reject(e){this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=null),this._reject?this._reject(e):this._reason=e}};var we=class{next(){return 0}},Cr=class extends we{next(){return Math.random()}},Tr=class extends we{constructor(e){super();this.seed=e,this.a=e}next(){var e=this.a+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}},y=class{static get RAND(){let e=new this;return this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this),Object.defineProperty(this,"RAND",{value:e}),e}constructor(e=void 0){typeof e=="number"?this.generator=new Tr(e):e?this.generator=e:this.generator=new Cr,this.next=this.next.bind(this),this.choose=this.choose.bind(this),this.range=this.range.bind(this),this.rangeInt=this.rangeInt.bind(this),this.sign=this.sign.bind(this)}static next(){return this.RAND.next()}next(){return this.generator.next()}static choose(e){return this.RAND.choose(e)}choose(e){return e[Math.floor(this.generator.next()*e.length)]}static range(e,r){return this.RAND.range(e,r)}range(e,r){return(r-e)*this.generator.next()+e}static rangeInt(e,r){return this.RAND.rangeInt(e,r)}rangeInt(e,r){return Math.trunc(this.range(e,r))}static sign(){return this.RAND.sign()}sign(){return this.generator.next()<.5?-1:1}};window.addEventListener("error",Or,!0);window.addEventListener("unhandledrejection",Or,!0);function Or(t){t instanceof PromiseRejectionEvent?window.alert(t.reason.stack):t instanceof ErrorEvent?window.alert(t.error.stack):window.alert(JSON.stringify(t))}async function Lr(t){let e=Ae.AUDIO_CONTEXT,r=await e.decodeAudioData(t);return new Ae(e,r)}var Ae=class{static get AUDIO_CONTEXT(){let e=new AudioContext;return ci(e),Object.defineProperty(this,"AUDIO_CONTEXT",{value:e}),e}constructor(e,r){this.audioContext=e,this.audioBuffer=r,this._playing=!1,this._started=!1,this._source=null,this.onAudioSourceEnded=this.onAudioSourceEnded.bind(this)}onAudioSourceEnded(){this._playing=!1}play(e={}){let r=this.audioBuffer;if(!r)return;this._source&&this.destroy();let{pitch:i=0,gain:n=0,pan:o=0,loop:s=!1}=e,c=this.audioContext,u=c.createBufferSource();u.addEventListener("ended",this.onAudioSourceEnded),u.buffer=r,u.loop=s;let p=u;if(i&&(u.detune.value=i*100),n){let v=c.createGain();v.gain.value=n,p=p.connect(v)}if(o){let v=c.createStereoPanner();v.pan.value=o,p=p.connect(v)}p.connect(c.destination),u.start(),this._source=u,this._started=!0,this._playing=!0}pause(){this._source.stop(),this._playing=!1}destroy(){this._source&&this._source.disconnect(),this._source=null,this._started=!1,this._playing=!1}isStarted(){return this._started}isPlaying(){return this._playing}isPaused(){return this._started&&!this._playing}};function ci(t){let e=()=>{t.state==="suspended"&&t.resume()};document.addEventListener("click",e)}var Hr={};function ct(){return Hr}async function $r(t){await Promise.all([_t("start",t.files.get("res/start.wav")),_t("dead",t.files.get("res/dead.wav")),_t("pop",t.files.get("res/boop.wav")),_t("music",t.files.get("res/music.wav")),_t("shoot",t.files.get("res/click.wav")),_t("boom",t.files.get("res/boom.wav"))])}async function _t(t,e){let r=new ArrayBuffer(e.byteLength);new Uint8Array(r).set(e),Hr[t]=await Lr(r)}var fi=[2,4],pi=[.3,1],gi=30;function kr(t,e){let r={x:[],y:[],size:[],speed:[],length:0,width:t,height:e};for(let i=0;i<gi;++i)r.x.push(y.range(0,t)),r.y.push(y.range(0,e)),r.size.push(y.range(...fi)),r.speed.push(y.range(...pi)),r.length++;return r}function Pr(t,e,r="white"){for(let i=0;i<e.length;++i){let n=e.x[i],o=e.y[i],s=e.size[i],c=s/2;t.fillStyle=r,t.fillRect(n-c,o-c,s,s)}}function Ir(t,e=1,r=0){let{length:i,width:n,height:o}=t;for(let s=0;s<i;++s){let c=e*t.speed[s],u=r*t.speed[s];t.x[s]+=c,t.y[s]+=u,c<0?t.x[s]<0&&(t.x[s]=n,t.y[s]=y.range(0,o)):c>0&&t.x[s]>n&&(t.x[s]=0,t.y[s]=y.range(0,o)),u<0?t.y[s]<0&&(t.x[s]=y.range(0,n),t.y[s]=o):u>0&&t.y[s]>o&&(t.x[s]=y.range(0,n),t.y[s]=0)}}var vi=document.querySelector("#display"),L=vi.canvas,di=L.getContext("2d"),_e=0,Kt={load:yi,start:mi,update:wi,render:Ai};window.addEventListener("DOMContentLoaded",_i);function _i(){Kt.load().then(()=>{Kt.start(),Mr(_e=performance.now())})}function Mr(t){requestAnimationFrame(Mr);let e=t-_e;_e=t,Kt.update(e),Kt.render(di)}var lt=5,Tt=4,H=8,Nr=[[-H,-H,H*2+L.width,H],[-H,0,H,L.height],[-H,L.height,H*2+L.width,H],[L.width,0,H,L.height]],Ee=[3e3,1e4],Ei=1,Si=100,M=1,yt=2,Zt=4,Ri=2e3,xi=100,Dr=10,Ot=4,zr=2,Lt=600,Ur=.1,bi=["red","red","red","yellow","orange"],Br=["blue","blue","blue","dodgerblue","gray","darkgray","yellow"],Ci=["gray","darkgray","lightgray"],Ti="[ wasd_ ]",Fr=[-2,2],Gr=1.5,Oi=.1,Li=.4,Se=.1,qr=.02,Hi=.008,$i=.1,Wr=.001,ki="gold";var ft=4,Pi=["white","violet","violet"],Ii=30,Mi=.7,Re=!1;async function yi(){console.log("Loading...");let t=document.querySelector("#assets"),e=new Promise((r,i)=>{t.addEventListener("load",r),t.addEventListener("error",i)});t.src="res.pack",await e,await $r(t),console.log("...loading complete!")}function mi(){this.level=0,this.score=0,this.highScore=Number(localStorage.getItem("highscore")),this.flashScoreDelta=0,this.flashHighScoreDelta=0,this.flashShootDelta=0,this.player={scene:this,x:L.width/2,y:L.height/2,rotation:0,dx:0,dy:0,dr:0,left:0,right:0,up:0,down:0,cooldown:0,powerMode:0,shoot(){if(!(this.scene.bullets.length>xi)&&!(this.cooldown>0)){if(this.powerMode>0){for(let t=-1;t<=1;++t){let e=this.rotation+t*Math.PI/4,r=jr(this.scene,this.x-Math.cos(e)*lt,this.y-Math.sin(e)*lt,-Math.cos(e)*Zt+this.dx,-Math.sin(e)*Zt+this.dy);this.scene.bullets.push(r)}--this.powerMode}else{let t=jr(this.scene,this.x-Math.cos(this.rotation)*lt,this.y-Math.sin(this.rotation)*lt,-Math.cos(this.rotation)*Zt+this.dx,-Math.sin(this.rotation)*Zt+this.dy);this.scene.bullets.push(t)}this.cooldown=Dr,ct().shoot.play()}}},this.asteroids=[],this.asteroidSpawner={scene:this,spawnTicks:Ee[1],reset(){this.spawnTicks=Ee[1]},spawn(){if(this.scene.asteroids.length>Si)return;let t=y.choose(Nr),e=Ht(this.scene,y.range(t[0],t[0]+t[2]),y.range(t[1],t[1]+t[3]),y.range(-M,M),y.range(-M,M),H);this.scene.asteroids.push(e)},update(t){this.scene.gamePause||(this.spawnTicks-=t,this.spawnTicks<=0&&(this.spawn(),this.spawnTicks=y.range(...Ee)))}},this.bullets=[],this.particles=[],this.powerUps=[],this.powerUpSpawner={scene:this,reset(){},spawn(){let t=y.choose(Nr),e=Ni(this.scene,y.range(t[0],t[0]+t[2]),y.range(t[1],t[1]+t[3]),y.range(-M,M),y.range(-M,M));this.scene.powerUps.push(e)},update(t){}},this.starfield=kr(L.width,L.height),this.gamePause=!0,this.showPlayer=!0,this.gameStart=!0,this.gameWait=!0,this.hint=Ti,document.addEventListener("keydown",t=>Di.call(this,t.key)),document.addEventListener("keyup",t=>zi.call(this,t.key))}function wi(t){if(this.gamePause){for(let n of this.particles)n.age+=t,n.age>Lt?n.destroy():(n.x+=n.dx,n.y+=n.dy,Et(n,Ot*2,Ot*2));return}let e=this.player.right-this.player.left,r=this.player.down-this.player.up,i=this.player.fire;this.player.dx+=r*Math.cos(this.player.rotation)*qr,this.player.dy+=r*Math.sin(this.player.rotation)*qr,this.player.dx*=1-Wr,this.player.dy*=1-Wr,this.player.dr+=e*Hi,this.player.dr*=1-$i,this.player.x+=this.player.dx,this.player.y+=this.player.dy,this.player.rotation+=this.player.dr,--this.player.cooldown,Et(this.player,lt*2,lt*2),i&&(this.player.shoot(),this.flashShootDelta=1),r&&Bi(this,this.player.x,this.player.y,-r*Math.cos(this.player.rotation)*Gr,-r*Math.sin(this.player.rotation)*Gr,y.choose.bind(null,Ci));for(let n of this.bullets)n.age+=t,n.age>Ri?n.destroy():(n.x+=n.dx,n.y+=n.dy,Et(n,yt*2,yt*2));for(let n of this.bullets)for(let o of this.asteroids)if(xe(n,o,o.size)){this.flashScore=1,this.score++,this.score>this.highScore&&(this.flashHighScore=this.score-this.highScore,this.highScore=this.score,localStorage.setItem("highscore",this.highScore)),Yt(this,o.x,o.y,10,y.choose.bind(null,Br)),ct().pop.play(),n.destroy(),o.breakUp(n.dx*Ur,n.dy*Ur);break}for(let n of this.particles)n.age+=t,n.age>Lt?n.destroy():(n.x+=n.dx,n.y+=n.dy,Et(n,Ot*2,Ot*2));for(let n of this.asteroids)n.x+=n.dx,n.y+=n.dy,Et(n,n.size*2,n.size*2);for(let n of this.asteroids)if(xe(n,this.player,n.size+lt)){Yt(this,n.x,n.y,10,y.choose.bind(null,Br)),n.destroy(),Ui(this);break}for(let n of this.powerUps)n.x+=n.dx,n.y+=n.dy,Et(n,ft*2,ft*2);for(let n of this.powerUps)if(xe(n,this.player,ft+lt)){Yt(this,n.x,n.y,10,y.choose.bind(null,Pi)),n.destroy(),this.player.powerMode+=Ii;break}Ir(this.starfield),this.asteroidSpawner.update(t),this.powerUpSpawner.update(t),!this.gamePause&&this.asteroids.length<=0&&(this.gamePause=!0,this.showPlayer=!0,ct().start.play(),setTimeout(()=>this.gameWait=!0,1e3))}function Ai(t){t.fillStyle="black",t.fillRect(0,0,L.width,L.height),Pr(t,this.starfield),t.fillStyle="rgba(255, 255, 255, 0.2)",t.textAlign="center",t.textBaseline="middle",t.font="16px sans-serif",t.fillText(this.hint,L.width/2,L.height/2-32),this.flashScore>0?(t.fillStyle=`rgba(255, 255, 255, ${this.flashScore+.2})`,this.flashScore-=Se):t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="48px sans-serif",t.fillText("= "+String(this.score).padStart(2,"0")+" =",L.width/2,L.height/2),this.flashHighScore>0?(t.fillStyle=`rgba(255, 255, 255, ${this.flashHighScore+.2})`,this.flashHighScore-=Se):t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="16px sans-serif",t.fillText(String(this.highScore).padStart(2,"0"),L.width/2,L.height/2+32),t.fillStyle="rgba(255, 255, 255, 0.2)",t.font="24px sans-serif",t.textAlign="right",t.fillText(Math.ceil(this.asteroidSpawner.spawnTicks/1e3),L.width,L.height-12);for(let e of this.asteroids)t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle="slategray",t.fillRect(-e.size,-e.size,e.size*2,e.size*2),t.setTransform(1,0,0,1,0,0),Qt(t,e.x,e.y,e.size);for(let e of this.powerUps)t.translate(e.x,e.y),t.rotate(e.rotation),t.beginPath(),t.strokeStyle="violet",t.arc(0,0,ft,0,Math.PI*2),t.moveTo(-ft/2,0),t.lineTo(ft/2,0),t.moveTo(0,-ft/2),t.lineTo(0,ft/2),t.stroke(),t.setTransform(1,0,0,1,0,0),Qt(t,e.x,e.y,ft);for(let e of this.bullets)t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle=ki,t.fillRect(-yt,-yt,yt*4,yt*2),t.setTransform(1,0,0,1,0,0),Qt(t,e.x,e.y,yt);for(let e of this.particles){t.translate(e.x,e.y),t.rotate(e.rotation),t.fillStyle=e.color;let r=Ot*(1-e.age/Lt);t.fillRect(-r,-r,r*2,r*2),t.setTransform(1,0,0,1,0,0)}if(this.showPlayer){t.translate(this.player.x,this.player.y),t.rotate(this.player.rotation),t.fillStyle="white";let e=lt;t.fillRect(-e,-e,e*2,e*2);let r=-1,i=0,n=0;this.flashShootDelta>0?(t.fillStyle=`rgb(${200*this.flashShootDelta+55*Math.sin(performance.now()/(Dr*2))}, 0, 0)`,this.flashShootDelta-=Se,n=this.flashShootDelta*2,r=this.flashShootDelta):t.fillStyle="black",t.fillRect(-e-n/2+r,-(e/4)-n/2+i,e+n,e/2+n),t.setTransform(1,0,0,1,0,0)}Qt(t,this.player.x,this.player.y,lt)}function Et(t,e,r){t.x<-e&&(t.x=L.width),t.y<-r&&(t.y=L.height),t.x>L.width+e/2&&(t.x=-e),t.y>L.height+r/2&&(t.y=-r)}function xe(t,e,r){let i=t.x-e.x,n=t.y-e.y;return i*i+n*n<=r*r}function Qt(t,e,r,i){!Re||(t.translate(e,r),t.beginPath(),t.arc(0,0,i,0,Math.PI*2),t.strokeStyle="lime",t.stroke(),t.setTransform(1,0,0,1,0,0))}function Ni(t,e,r,i,n){return{scene:t,x:e,y:r,dx:i,dy:n,rotation:Math.atan2(n,i),destroy(){this.scene.powerUps.splice(this.scene.powerUps.indexOf(this),1)}}}function Ht(t,e,r,i,n,o){return{scene:t,x:e,y:r,dx:i,dy:n,size:o,rotation:Math.atan2(n,i),breakUp(s=0,c=0){if(this.destroy(),this.size>Tt){let u=[];u.push(Ht(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+c,Tt)),u.push(Ht(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+c,Tt)),u.push(Ht(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+c,Tt)),u.push(Ht(this.scene,this.x+y.range(-H,H),this.y+y.range(-H,H),y.range(-M,M)+s,y.range(-M,M)+c,Tt)),this.scene.asteroids.push(...u)}},destroy(){this.scene.asteroids.splice(this.scene.asteroids.indexOf(this),1)}}}function jr(t,e,r,i,n){return{scene:t,x:e,y:r,dx:i,dy:n,rotation:Math.atan2(n,i),age:0,destroy(){this.scene.bullets.splice(this.scene.bullets.indexOf(this),1)}}}function Xr(t,e,r,i,n,o){return typeof o=="function"&&(o=o.call(null)),{scene:t,x:e,y:r,dx:i,dy:n,rotation:Math.atan2(n,i),age:0,color:o,destroy(){this.scene.particles.splice(this.scene.particles.indexOf(this),1)}}}function Fi(t){t.bullets.length=0,t.asteroids.length=0,t.particles.length=0,t.player.x=L.width/2,t.player.y=L.height/2,t.player.dx=0,t.player.dy=0,t.level++,t.gamePause=!1,t.showPlayer=!0;for(let e=0;e<Ei*t.level;++e)t.asteroidSpawner.spawn();y.next()>Mi&&t.powerUpSpawner.spawn(),ct().music.isPlaying()||ct().music.play({loop:!0})}function Ui(t){t.gamePause=!0,t.showPlayer=!1,Yt(t,t.player.x,t.player.y,100,y.choose.bind(null,bi)),ct().dead.play(),ct().boom.play(),setTimeout(()=>t.gameStart=t.gameWait=!0,1e3)}function Bi(t,e,r,i,n,o){if(y.next()>.3){let s=Xr(t,e+y.range(...Fr),r+y.range(...Fr),i,n,o);s.age=y.range(Lt*Oi,Lt*Li),t.particles.push(s)}}function Yt(t,e,r,i=10,n){for(let o=0;o<i;++o)t.particles.push(Xr(t,e,r,y.range(-1,1)*zr,y.range(-1,1)*zr,n))}function Di(t){switch(this.gameWait&&(this.gameStart&&(ct().music.play(),this.score=0,this.flashScore=!0,this.level=0,this.gameStart=!1,this.player.powerMode=0,this.powerUps.length=0,this.asteroidSpawner.reset(),this.powerUpSpawner.reset()),this.gameWait=!1,Fi(this)),t){case"w":case"ArrowUp":this.player.up=1;break;case"s":case"ArrowDown":this.player.down=1;break;case"a":case"ArrowLeft":this.player.left=1;break;case"d":case"ArrowRight":this.player.right=1;break;case" ":this.player.fire=1;break;case"\\":break;default:console.log(t)}}function zi(t){switch(t){case"w":case"ArrowUp":this.player.up=0;break;case"s":case"ArrowDown":this.player.down=0;break;case"a":case"ArrowLeft":this.player.left=0;break;case"d":case"ArrowRight":this.player.right=0;break;case" ":this.player.fire=0;break;case"\\":Re=!Re;break;default:console.log(t)}}})();
//# sourceMappingURL=main.js.map
