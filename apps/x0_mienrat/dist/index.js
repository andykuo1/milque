!function(){"use strict";const t="noscale";class e extends HTMLElement{static get[Symbol.for("cuttleTemplate")](){let t=document.createElement("template");return t.innerHTML='<div class="container">\n    <label class="hidden" id="title">display-port</label>\n    <label class="hidden" id="fps">00</label>\n    <label class="hidden" id="dimension">0x0</label>\n    <canvas></canvas>\n    <slot></slot>\n</div>',Object.defineProperty(this,Symbol.for("cuttleTemplate"),{value:t}),t}static get[Symbol.for("cuttleStyle")](){let t=document.createElement("style");return t.innerHTML=":host{display:inline-block;color:#555}.container{display:flex;position:relative;width:100%;height:100%}canvas{background:#000;margin:auto;-ms-interpolation-mode:nearest-neighbor;image-rendering:-moz-crisp-edges;image-rendering:pixelated}label{font-family:monospace;color:currentColor;position:absolute}#title{left:.5rem;top:.5rem}#fps{right:.5rem;top:.5rem}#dimension{left:.5rem;bottom:.5rem}.hidden{display:none}:host([debug]) .container{outline:6px dashed rgba(0,0,0,.1);outline-offset:-4px;background-color:rgba(0,0,0,.1)}:host([mode=noscale]) canvas{margin:0;top:0;left:0}:host([mode=center]),:host([mode=fit]),:host([mode=stretch]){width:100%;height:100%}:host([full]){width:100vw!important;height:100vh!important}:host([disabled]){display:none}slot{display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;width:100%;height:100%;top:0;left:0;pointer-events:none}::slotted(*){pointer-events:auto}",Object.defineProperty(this,Symbol.for("cuttleStyle"),{value:t}),t}static get observedAttributes(){return["onframe","width","height","disabled","debug","id","class"]}static get properties(){return{width:Number,height:Number,disabled:Boolean,debug:Boolean,mode:{type:String,value:"fit",observed:!1}}}get mode(){return this.getAttribute("mode")}set mode(t){this.setAttribute("mode",t)}get debug(){return this._debug}set debug(t){this.toggleAttribute("debug",t)}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get height(){return this._height}set height(t){this.setAttribute("height",String(t))}get width(){return this._width}set width(t){this.setAttribute("width",String(t))}static get customEvents(){return["frame"]}get onframe(){return this._onframe}set onframe(t){this._onframe&&this.removeEventListener("frame",this._onframe),this._onframe=t,this._onframe&&this.addEventListener("frame",t)}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleTemplate")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleStyle")].cloneNode(!0)),this._canvasElement=this.shadowRoot.querySelector("canvas"),this._titleElement=this.shadowRoot.querySelector("#title"),this._fpsElement=this.shadowRoot.querySelector("#fps"),this._dimensionElement=this.shadowRoot.querySelector("#dimension"),this._animationRequestHandle=0,this._prevAnimationFrameTime=0,this._width=300,this._height=150,this.update=this.update.bind(this)}get canvas(){return this._canvasElement}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"onframe")){let t=this.onframe;delete this.onframe,this.onframe=t}if(Object.prototype.hasOwnProperty.call(this,"width")){let t=this.width;delete this.width,this.width=t}if(Object.prototype.hasOwnProperty.call(this,"height")){let t=this.height;delete this.height,this.height=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}if(Object.prototype.hasOwnProperty.call(this,"debug")){let t=this.debug;delete this.debug,this.debug=t}if(Object.prototype.hasOwnProperty.call(this,"mode")){let t=this.mode;delete this.mode,this.mode=t}this.hasAttribute("mode")||this.setAttribute("mode","fit"),this.hasAttribute("tabindex")||this.setAttribute("tabindex",0),this.updateCanvasSize(),this.resume()}disconnectedCallback(){this.pause()}attributeChangedCallback(t,e,s){switch(t){case"width":this._width=Number(s);break;case"height":this._height=Number(s);break;case"disabled":this._disabled=null!==s;break;case"debug":this._debug=null!==s;break;case"onframe":this.onframe=new Function("event","with(document){with(this){"+s+"}}").bind(this)}((t,e,s)=>{switch(t){case"disabled":s?(this.update(0),this.pause()):this.resume();break;case"id":case"class":this._titleElement.innerHTML=`display-port${this.className?"."+this.className:""}${this.hasAttribute("id")?"#"+this.getAttribute("id"):""}`;break;case"debug":this._titleElement.classList.toggle("hidden",s),this._fpsElement.classList.toggle("hidden",s),this._dimensionElement.classList.toggle("hidden",s)}})(t,0,s)}pause(){cancelAnimationFrame(this._animationRequestHandle)}resume(){this._animationRequestHandle=requestAnimationFrame(this.update)}update(e){this._animationRequestHandle=requestAnimationFrame(this.update),this.updateCanvasSize();const s=e-this._prevAnimationFrameTime;if(this._prevAnimationFrameTime=e,this.debug){const e=s<=0?"--":String(Math.round(1e3/s)).padStart(2,"0");if(this._fpsElement.innerText!==e&&(this._fpsElement.innerText=e),this.mode===t){let t=`${this._width}x${this._height}`;this._dimensionElement.innerText!==t&&(this._dimensionElement.innerText=t)}else{let t=`${this._width}x${this._height}|${this.shadowRoot.host.clientWidth}x${this.shadowRoot.host.clientHeight}`;this._dimensionElement.innerText!==t&&(this._dimensionElement.innerText=t)}}this.dispatchEvent(new CustomEvent("frame",{detail:{now:e,prevTime:this._prevAnimationFrameTime,deltaTime:s,canvas:this._canvasElement},bubbles:!1,composed:!0}))}updateCanvasSize(){let e=this.shadowRoot.host.getBoundingClientRect();const s=e.width,n=e.height;let i=this._canvasElement,o=this._width,r=this._height;const a=this.mode;if("stretch"===a)o=s,r=n;else if(a!==t){if(s<o||n<r||"fit"===a){let t=s/o,e=n/r;t<e?(o=s,r*=t):(o*=e,r=n)}}o=Math.floor(o),r=Math.floor(r),i.clientWidth===o&&i.clientHeight===r||(i.width=this._width,i.height=this._height,i.style=`width: ${o}px; height: ${r}px`,this.dispatchEvent(new CustomEvent("resize",{detail:{width:o,height:r},bubbles:!1,composed:!0})))}}window.customElements.define("display-port",e);const s=1,n=2,i=3,o={NULL:0,DOWN:1,UP:2,MOVE:3,parse(t){if("string"!=typeof t)return o.NULL;switch(t.toLowerCase()){case"down":return o.DOWN;case"up":return o.UP;case"move":return o.MOVE;default:return o.NULL}}},r="*";class a{static isAxis(t){return!1}static isButton(t){return!1}constructor(t,e){this.deviceName=t,this.eventTarget=e,this.listeners={}}destroy(){this.listeners={}}addInputListener(t,e){let s=this.listeners[t];s?s.push(e):(s=[e],this.listeners[t]=s)}removeInputListener(t,e){let s=this.listeners[t];s&&(s.indexOf(e),s.splice(e,1))}dispatchInput(t){const{keyCode:e}=t,s=this.listeners[e];let n=!1;if(s){for(let e of s)n|=e(t);return n}for(let e of this.listeners["*"])n|=e(t);return n}}class l{static createAdapter(t,e,s,n,i,o){return{target:t,adapterId:e,deviceName:s,keyCode:n,scale:i,eventCode:o}}constructor(){this.adapters={"*":h()}}add(t){for(let e of t){const{deviceName:t,keyCode:s}=e;let n;t in this.adapters?n=this.adapters[t]:(n=h(),this.adapters[t]=n),s in n?n[s].push(e):n[s]=[e]}}delete(t){for(let e of t){const{deviceName:t,keyCode:s}=e;if(t in this.adapters){let n=this.adapters[t];if(s in n){let t=n[s],i=t.indexOf(e);i>=0&&t.splice(i,1)}}}}clear(){for(let t in this.adapters)this.adapters[t]=h()}poll(t,e,s){const n=this.findAdapters(t,e);for(let t of n){const e=t.eventCode;if(e===o.NULL){const{target:e,scale:n}=t,i=s.value*n;e.poll(i,t)}else{const{target:n,scale:i}=t,o=s.getEvent(e)*i;n.poll(o,t)}}return n.length>0}update(t,e,s){let n=!1;for(let i of this.findAdapters(t,e)){const t=i.eventCode;if(t!==o.NULL){const{target:e,scale:o}=i,r=s.getEvent(t)*o;e.update(r,i),n=!0}}return n}reset(t,e,s){let n=!1;for(let s of this.findAdapters(t,e))s.target.reset(),n=!0;return n}findAdapters(t,e){let s=[];if(t in this.adapters){let n=this.adapters[t];e in n&&s.push(...n[e]),s.push(...n["*"])}let n=this.adapters["*"];return e in n&&s.push(...n[e]),s.push(...n["*"]),s}}function h(){return{[r]:[]}}class d{constructor(){this.value=0,this.prev=0}update(t){this.value=t}poll(){this.prev=this.value,this.value=0}getEvent(t){return 0}getState(){return this.value}getPrevState(){return this.prev}}class u extends d{constructor(){super(),this.delta=0,this.next={delta:0}}update(t,e){this.value=t,this.next.delta+=e}poll(){this.prev=this.value,this.delta=this.next.delta,this.next.delta=0}getEvent(t){switch(t){case o.MOVE:return this.delta;default:return super.getEvent(t)}}}class c extends d{constructor(){super(),this.down=!1,this.up=!1,this.next={down:!1,up:!1}}update(t){t?this.next.down=!0:this.next.up=!0}poll(){this.prev=this.value;const{up:t,down:e}=this.next;this.value?this.up&&!t&&(this.value=0):e&&(this.value=1),this.down=e,this.up=t,this.next.down=!1,this.next.up=!1}getEvent(t){switch(t){case o.DOWN:return 1&this.down;case o.UP:return 1&this.up;default:return super.getEvent(t)}}}const p=1,m=2;class v{constructor(t=[]){this.onInputEvent=this.onInputEvent.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this);let e={},s={};for(let n of t){const t=n.deviceName;if(t in e)throw new Error(`Another device with name '${t}' already exists.`);e[t]=n,s[t]={},n.addInputListener(r,this.onInputEvent)}this.devices=e,this.keyMap=s,this.listeners={poll:[],update:[]},this._lastPollTime=-1,this._autopoll=!1,this._animationFrameHandle=null}get polling(){return performance.now()-this._lastPollTime<1e3}destroy(){this.clearKeys();for(let t in this.devices){let e=this.devices[t];e.removeInputListener(r,this.onInputEvent),e.destroy()}this.devices={}}poll(t=performance.now()){for(const t in this.keyMap){let e=this.keyMap[t];for(const s in e){let n=b(e[s]);n.poll(),this.dispatchInputEvent(m,t,s,n)}}this.dispatchPollEvent(t),this._lastPollTime=t}addEventListener(t,e){t in this.listeners?this.listeners[t].unshift(e):this.listeners[t]=[e]}removeEventListener(t,e){if(t in this.listeners){let s=this.listeners[t],n=s.indexOf(e);s.splice(n,1)}}countEventListeners(t){if(!(t in this.listeners))throw new Error(`Cannot count listeners for unknown event '${t}'.`);return this.listeners[t].length}dispatchEvent(t,e){for(let s of this.listeners[t])s(e)}dispatchInputEvent(t,e,s,n){this.dispatchEvent("input",{stage:t,deviceName:e,keyCode:s,input:n})}dispatchPollEvent(t){this.dispatchEvent("poll",{now:t})}onInputEvent(t){const e=t.deviceName,r=this.keyMap[e];switch(t.type){case s:{const s=t.keyCode;let n=b(r[s]);if(n)return n.update(t.event===o.DOWN),this.dispatchInputEvent(p,e,s,n),!0}break;case n:{let s=b(r.PosX);s&&(s.update(t.x,t.dx),this.dispatchInputEvent(p,e,"PosX",s));let n=b(r.PosY);n&&(n.update(t.y,t.dy),this.dispatchInputEvent(p,e,"PosY",n))}break;case i:{let s=b(r.WheelX);s&&(s.update(t.dx,t.dx),this.dispatchInputEvent(p,e,"WheelX",s));let n=b(r.WheelY);n&&(n.update(t.dy,t.dy),this.dispatchInputEvent(p,e,"WheelY",n));let i=b(r.WheelZ);i&&(i.update(t.dz,t.dz),this.dispatchInputEvent(p,e,"WheelZ",i))}}}onAnimationFrame(t){this._autopoll&&(this._animationFrameHandle=requestAnimationFrame(this.onAnimationFrame),this.poll(t))}set autopoll(t){this._autopoll=t,this._animationFrameHandle&&(cancelAnimationFrame(this._animationFrameHandle),this._animationFrameHandle=null),t&&(this._animationFrameHandle=requestAnimationFrame(this.onAnimationFrame))}get autopoll(){return this._autopoll}registerKey(t,e){if(!(t in this.devices))throw new Error(`Invalid device name - missing device with name '${t}' in source.`);let s=this.keyMap[t];if(e in s)s[e].refs+=1;else{let n,i=this.devices[t];if(i.constructor.isAxis(e))n=new u;else{if(!i.constructor.isButton(e))throw new Error(`Unknown key code '${e}' for device ${t}.`);n=new c}s[e]=function(t=null){return{refs:1,input:t}}(n)}return this}unregisterKey(t,e){let s=this.keyMap[t];if(s){let t=s[e];t&&(!function(t){t.refs-=1}(t),t.refs<=0&&delete s[e])}}hasKey(t,e){return t in this.keyMap&&e in this.keyMap[t]}clearKeys(){for(let t in this.devices){let e=this.keyMap[t];for(let t in e)e[t].refs=0;this.keyMap[t]={}}}getInputByKey(t,e){return b(this.keyMap[t][e])}}function b(t){return t?t.input:null}class f extends d{constructor(){super(),this.update=this.update.bind(this),this.adapters=[],this.values=[],this.next={values:[],value:0}}hydrate(t){if(!t)return;Array.isArray(t)||(t=[t]);let e=[],s=0;for(let n of t){"string"==typeof n&&(n={key:n});const{key:t,scale:i=1,event:r="null"}=n,{deviceName:a,keyCode:h}=g(t),d=o.parse(r),u=Number(i);let c=l.createAdapter(this,s,a,h,u,d);e.push(c),++s}this.adapters=e,this.values=new Array(e.length).fill(0),this.next={values:new Array(e.length).fill(0),value:0}}poll(t,e){this.prev=this.value;const s=e.adapterId;let n=this.values[s];this.values[s]=t,this.value=this.value-n+t,this.next.values[s]=0,this.next.value+=t-n}update(t,e){const s=e.adapterId;let n=this.next.values[s];this.next.values[s]=t,this.next.value+=t-n}reset(){this.prev=0,this.values.fill(0),this.value=0,this.next.values.fill(0),this.next.value=0}}function g(t){let e=t.indexOf(":");if(e>=0)return{deviceName:t.substring(0,e),keyCode:t.substring(e+1)};throw new Error("Invalid key string - missing device separator ':'.")}class y{constructor(){this._source=null,this._mapping=null,this._disabled=!0,this._ignoreInputs=this._disabled,this.adapters=new l,this.inputs={},this.listeners={change:[],attach:[],detach:[]},this.onSourceInput=this.onSourceInput.bind(this),this.onSourcePoll=this.onSourcePoll.bind(this)}get source(){return this._source}get mapping(){return this._mapping}get disabled(){return this._disabled}set disabled(t){this.toggle(!t)}setInputMapping(t){const e=this.disabled;this.disabled=!0;let s=this.source,n=this.inputs;s&&w(s,n),this.adapters.clear();let i=this.source,o={};if(t){for(let e in t){let s=t[e],i=n[e]||new f;i.hydrate(s);let r=i.adapters;this.adapters.add(r),o[e]=i}i&&_(i,o)}return this.inputs=o,this._mapping=t,this.dispatchChangeEvent(),this.disabled=!this.source||!this.inputs||e,this}attach(t){if(this.source)throw new Error("Already attached to existing input source.");if(!t)throw new Error("Missing input source to attach context.");return _(t,this.inputs),t.addEventListener("poll",this.onSourcePoll),t.addEventListener("input",this.onSourceInput),this._source=t,this.toggle(!0),this.dispatchAttachEvent(),this}detach(){let t=this.source,e=this.inputs;return t&&(this.toggle(!1),t.removeEventListener("poll",this.onSourcePoll),t.removeEventListener("input",this.onSourceInput),e&&w(t,e),this._source=null,this.dispatchDetachEvent()),this}addEventListener(t,e){t in this.listeners?this.listeners[t].unshift(e):this.listeners[t]=[e]}removeEventListener(t,e){if(t in this.listeners){let s=this.listeners[t],n=s.indexOf(e);s.splice(n,1)}}countEventListeners(t){if(!(t in this.listeners))throw new Error(`Cannot count listeners for unknown event '${t}'.`);return this.listeners[t].length}dispatchEvent(t,e){for(let s of this.listeners[t])s(e)}dispatchChangeEvent(){this.dispatchEvent("change",{})}dispatchAttachEvent(){this.dispatchEvent("attach",{})}dispatchDetachEvent(){this.dispatchEvent("detach",{})}onSourceInput(t){if(t.consumed||this._ignoreInputs){const{deviceName:e,keyCode:s,input:n}=t;this.adapters.reset(e,s,n)}else{const{stage:e,deviceName:s,keyCode:n,input:i}=t;switch(e){case m:this.adapters.poll(s,n,i);break;case p:this.adapters.update(s,n,i);break;default:throw new Error("Unknown input source stage.")}t.consumed=!0}}onSourcePoll(t){this._ignoreInputs!==this.disabled&&(this._ignoreInputs=this.disabled)}toggle(t=this._disabled){let e=!t;if(!e&&!this.source)throw new Error("Input source must be set before enabling input context.");return this._disabled=e,this}hasInput(t){return t in this.inputs&&this.inputs[t].adapters.length>0}getInput(t){if(t in this.inputs)return this.inputs[t];{let e=new f;return this.inputs[t]=e,this._mapping[t]="",this.dispatchChangeEvent(),e}}getInputState(t){return t in this.inputs?this.inputs[t].value:0}getInputChanged(t){if(t in this.inputs){let e=this.inputs[t];return e.value-e.prev}return 0}}function _(t,e){for(let s in e){let{adapters:n}=e[s];for(let e of n){const{deviceName:s,keyCode:n}=e;t.registerKey(s,n)}}}function w(t,e){for(let s in e){let{adapters:n}=e[s];for(let e of n){const{deviceName:s,keyCode:n}=e;t.unregisterKey(s,n)}}}class E extends a{static isAxis(t){return!1}static isButton(t){return!0}constructor(t,e={}){super("Keyboard",t);const{repeat:n=!1}=e;this.repeat=n,this._eventObject={target:t,deviceName:this.deviceName,keyCode:"",event:o.NULL,type:s,value:0,control:!1,shift:!1,alt:!1},this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)}destroy(){let t=this.eventTarget;t.removeEventListener("keydown",this.onKeyDown),t.removeEventListener("keyup",this.onKeyUp),super.destroy()}onKeyDown(t){if(t.repeat)return t.preventDefault(),t.stopPropagation(),!1;let e=this._eventObject;return e.keyCode=t.code,e.event=o.DOWN,e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInput(e)?(t.preventDefault(),t.stopPropagation(),!1):void 0}onKeyUp(t){let e=this._eventObject;if(e.keyCode=t.code,e.event=o.UP,e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInput(e))return t.preventDefault(),t.stopPropagation(),!1}}class S extends a{static isAxis(t){return"PosX"===t||"PosY"===t||"WheelX"===t||"WheelY"===t||"WheelZ"===t}static isButton(t){return!this.isAxis(t)}constructor(t,e={eventsOnFocus:!0}){super("Mouse",t),this.canvasTarget=t instanceof HTMLCanvasElement&&t||t.canvas||t.querySelector("canvas")||t.shadowRoot&&t.shadowRoot.querySelector("canvas")||t,this.eventsOnFocus=e.eventsOnFocus,this._downHasFocus=!1,this._eventObject={target:t,deviceName:this.deviceName,keyCode:"",event:o.NULL,type:s,value:0,control:!1,shift:!1,alt:!1},this._positionObject={target:t,deviceName:this.deviceName,keyCode:"Position",event:o.MOVE,type:n,x:0,y:0,dx:0,dy:0},this._wheelObject={target:t,deviceName:this.deviceName,keyCode:"Wheel",event:o.MOVE,type:i,dx:0,dy:0,dz:0},this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("contextmenu",this.onContextMenu),t.addEventListener("wheel",this.onWheel),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){let t=this.eventTarget;t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("contextmenu",this.onContextMenu),t.removeEventListener("wheel",this.onWheel),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),super.destroy()}setPointerLock(t=!0){t?this.eventTarget.requestPointerLock():this.eventTarget.exitPointerLock()}hasPointerLock(){return document.pointerLockElement===this.eventTarget}onMouseDown(t){this._downHasFocus=!0;let e=this._eventObject;if(e.keyCode="Button"+t.button,e.event=o.DOWN,e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInput(e)&&document.activeElement===this.eventTarget)return t.preventDefault(),t.stopPropagation(),!1}onContextMenu(t){return t.preventDefault(),t.stopPropagation(),!1}onWheel(t){let e=this._wheelObject;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:e.dx=10*t.deltaX,e.dy=10*t.deltaY,e.dz=10*t.deltaZ;break;case WheelEvent.DOM_DELTA_PAGE:e.dx=100*t.deltaX,e.dy=100*t.deltaY,e.dz=100*t.deltaZ;break;case WheelEvent.DOM_DELTA_PIXEL:default:e.dx=t.deltaX,e.dy=t.deltaY,e.dz=t.deltaZ}if(this.dispatchInput(e))return t.preventDefault(),t.stopPropagation(),!1}onMouseUp(t){if(!this._downHasFocus)return;this._downHasFocus=!1;let e=this._eventObject;return e.keyCode="Button"+t.button,e.event=o.UP,e.value=1,e.control=t.ctrlKey,e.shift=t.shiftKey,e.alt=t.altKey,this.dispatchInput(e)?(t.preventDefault(),t.stopPropagation(),!1):void 0}onMouseMove(t){if(this.eventsOnFocus&&document.activeElement!==this.eventTarget)return;const e=this.canvasTarget,{clientWidth:s,clientHeight:n}=e,i=e.getBoundingClientRect();let o=t.movementX/s,r=t.movementY/n,a=(t.clientX-i.left)/s,l=(t.clientY-i.top)/n,h=this._positionObject;h.x=a,h.y=l,h.dx=o,h.dy=r,this.dispatchInput(h)}}class x extends HTMLElement{static get[Symbol.for("cuttleTemplate")](){let t=document.createElement("template");return t.innerHTML='<kbd>\n    <span id="key"><slot></slot></span>\n    <span id="value" class="hidden"></span>\n</kbd>\n',Object.defineProperty(this,Symbol.for("cuttleTemplate"),{value:t}),t}static get[Symbol.for("cuttleStyle")](){let t=document.createElement("style");return t.innerHTML='kbd{position:relative;display:inline-block;border-radius:3px;border:1px solid #888;font-size:.85em;font-weight:700;text-rendering:optimizeLegibility;line-height:12px;height:14px;padding:2px 4px;color:#444;background-color:#eee;box-shadow:inset 0 -3px 0 #aaa;overflow:hidden}kbd:empty:after{content:"<?>";opacity:.6}.disabled{opacity:.6;box-shadow:none;background-color:#aaa}.hidden{display:none}#value{position:absolute;top:0;bottom:0;right:0;font-size:.85em;padding:2px 4px 0;color:#ccc;background-color:#333;box-shadow:inset 0 3px 0 #222}',Object.defineProperty(this,Symbol.for("cuttleStyle"),{value:t}),t}static get properties(){return{name:String,value:String,disabled:Boolean}}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get value(){return this._value}set value(t){this.setAttribute("value",t)}get name(){return this._name}set name(t){this.setAttribute("name",t)}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleTemplate")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleStyle")].cloneNode(!0)),this._keyboardElement=this.shadowRoot.querySelector("kbd"),this._keyElement=this.shadowRoot.querySelector("#key"),this._valueElement=this.shadowRoot.querySelector("#value")}attributeChangedCallback(t,e,s){switch(t){case"name":this._name=s;break;case"value":this._value=s;break;case"disabled":this._disabled=null!==s}((t,e,s)=>{switch(t){case"name":this._keyElement.innerText=s;break;case"value":null!==s?(this._valueElement.classList.toggle("hidden",!1),this._valueElement.innerText=s,this._keyboardElement.style.paddingRight=`${this._valueElement.clientWidth+4}px`):this._valueElement.classList.toggle("hidden",!0);break;case"disabled":this._keyboardElement.classList.toggle("disabled",null!==s)}})(t,0,s)}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"name")){let t=this.name;delete this.name,this.name=t}if(Object.prototype.hasOwnProperty.call(this,"value")){let t=this.value;delete this.value,this.value=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}}static get observedAttributes(){return["name","value","disabled"]}}window.customElements.define("input-key",x);class D extends HTMLElement{static get[Symbol.for("cuttleTemplate")](){let t=document.createElement("template");return t.innerHTML='<table>\n    <thead>\n        <tr class="tableHeader">\n            <th colspan=4>\n                <slot></slot>\n            </th>\n        </tr>\n        <tr class="colHeader">\n            <th>name</th>\n            <th>key</th>\n            <th>mod</th>\n            <th>value</th>\n        </tr>\n    </thead>\n    <tbody>\n    </tbody>\n</table>\n',Object.defineProperty(this,Symbol.for("cuttleTemplate"),{value:t}),t}static get[Symbol.for("cuttleStyle")](){let t=document.createElement("style");return t.innerHTML=":host{display:block}table{border-collapse:collapse}table,td,th{border:1px solid #666}td,th{padding:5px 10px}td{text-align:center}thead th{padding:0}.colHeader>th{font-size:.8em;padding:0 10px;letter-spacing:3px;background-color:#aaa;color:#666}.colHeader>th,output{font-family:monospace}output{border-radius:.3em;padding:3px}tr:not(.primary) .name,tr:not(.primary) .value{opacity:.3}tr:nth-child(2n){background-color:#eee}",Object.defineProperty(this,Symbol.for("cuttleStyle"),{value:t}),t}static get customEvents(){return["load"]}get onload(){return this._onload}set onload(t){this._onload&&this.removeEventListener("load",this._onload),this._onload=t,this._onload&&this.addEventListener("load",t)}static get observedAttributes(){return["onload","src"]}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleTemplate")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleStyle")].cloneNode(!0)),this._src="",this._inputMap=null,this._tableElements={},this._titleElement=this.shadowRoot.querySelector("#title"),this._bodyElement=this.shadowRoot.querySelector("tbody"),this._children=this.shadowRoot.querySelector("slot")}get map(){return this._inputMap}get mapElements(){return this._tableElements}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"onload")){let t=this.onload;delete this.onload,this.onload=t}!function(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let s=t[e];delete t[e],t[e]=s}}(this,"src")}attributeChangedCallback(t,e,s){switch(t){case"onload":this.onload=new Function("event","with(document){with(this){"+s+"}}").bind(this)}((t,e,s)=>{switch(t){case"src":if(this._src!==s)if(this._src=s,s.trim().startsWith("{")){let t=JSON.parse(s);this._setInputMap(t)}else fetch(s).then((t=>t.json())).then((t=>this._setInputMap(t)))}})(t,0,s)}get src(){return this.getAttribute("src")}set src(t){switch(typeof t){case"object":{let e=JSON.stringify(t);this._src=e,this._setInputMap(t),this.setAttribute("src",e)}break;case"string":this.setAttribute("src",t);break;default:this.setAttribute("src",JSON.stringify(t))}}_setInputMap(t){let e={},s=[];for(let n in t){let i=[];k(i,n,t[n]),e[n]=i,s.push(...i)}this._bodyElement.innerHTML="";for(let t of s)this._bodyElement.appendChild(t);this._inputMap=t,this._tableElements=e,this.dispatchEvent(new CustomEvent("load",{bubbles:!1,composed:!0,detail:{map:t}}))}}function k(t,e,s){if(Array.isArray(s)){k(t,e,s[0]);let n=s.length;for(let i=1;i<n;++i)t.push(M(e,s[i],!1))}else t.push(M(e,s,!0));return t}function M(t,e,s=!0){if("object"==typeof e){const{key:n,event:i,scale:o}=e;return C(t,n,i,o,0,s)}return C(t,e,null,1,0,s)}function C(t,e,s,n,i,o=!0){let r=document.createElement("tr");o&&r.classList.add("primary");{let e=document.createElement("td");e.textContent=t,e.classList.add("name"),r.appendChild(e)}{let t=document.createElement("td");t.classList.add("key");let s=new x;s.innerText=e,t.appendChild(s),r.appendChild(t)}{let t=document.createElement("td"),e=document.createElement("samp"),i=[];"string"==typeof s&&"null"!==s&&i.push(s),"number"==typeof n&&1!==n&&i.push(`×(${n.toFixed(2)})`),e.innerText=i.join(" "),t.classList.add("mod"),t.appendChild(e),r.appendChild(t)}{let t=document.createElement("td"),e=document.createElement("output");e.innerText=Number(i).toFixed(2),e.classList.add("value"),t.appendChild(e),r.appendChild(t)}return r}window.customElements.define("input-map",D);const T=Symbol("inputSourceState");class L extends v{static for(t){if(t)return function(t){if(O(t)){let e=Object.getOwnPropertyDescriptor(t,T);return e.value.refs+=1,e.value.state}{let e=new v([new E(t),new S(t)]);return Object.defineProperty(t,T,{value:{state:e,refs:1},configurable:!0}),e}}(t);throw new Error("Cannot get input source for null event target.")}static delete(t){t&&function(t){if(O(t)){let e=Object.getOwnPropertyDescriptor(t,T);if(e.value.refs-=1,e.value.refs<=0){let s=e.value.state;delete t[T],s.destroy()}}}(t)}constructor(){throw super(),new Error("Cannot construct InputSource with new - use InputSourceState() instead.")}}function O(t){return Object.prototype.hasOwnProperty.call(t,T)&&Object.getOwnPropertyDescriptor(t,T).value}class P extends HTMLElement{static get[Symbol.for("cuttleTemplate")](){let t=document.createElement("template");return t.innerHTML='<div>\n    <label id="title">\n        input-source\n    </label>\n    <span>|</span>\n    <p>\n        <label for="poll">poll</label>\n        <output id="poll"></output>\n    </p>\n    <p>\n        <label for="focus">focus</label>\n        <output id="focus"></output>\n    </p>\n</div>\n',Object.defineProperty(this,Symbol.for("cuttleTemplate"),{value:t}),t}static get[Symbol.for("cuttleStyle")](){let t=document.createElement("style");return t.innerHTML=':host{display:inline-block}div{font-family:monospace;color:#666;outline:1px solid #666;padding:4px}p{display:inline;margin:0;padding:0}#focus:empty:after,#poll:empty:after{content:"✗";color:red}',Object.defineProperty(this,Symbol.for("cuttleStyle"),{value:t}),t}static get properties(){return{for:String,autopoll:Boolean}}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}static get customEvents(){return["input","poll","change"]}get onchange(){return this._onchange}set onchange(t){this._onchange&&this.removeEventListener("change",this._onchange),this._onchange=t,this._onchange&&this.addEventListener("change",t)}get onpoll(){return this._onpoll}set onpoll(t){this._onpoll&&this.removeEventListener("poll",this._onpoll),this._onpoll=t,this._onpoll&&this.addEventListener("poll",t)}get oninput(){return this._oninput}set oninput(t){this._oninput&&this.removeEventListener("input",this._oninput),this._oninput=t,this._oninput&&this.addEventListener("input",t)}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleTemplate")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleStyle")].cloneNode(!0)),this._containerElement=this.shadowRoot.querySelector("div"),this._titleElement=this.shadowRoot.querySelector("#title"),this._pollElement=this.shadowRoot.querySelector("#poll"),this._focusElement=this.shadowRoot.querySelector("#focus"),this._eventTarget=null,this._sourceState=null,this.onSourcePoll=this.onSourcePoll.bind(this),this.onSourceInput=this.onSourceInput.bind(this),this.onTargetFocus=this.onTargetFocus.bind(this),this.onTargetBlur=this.onTargetBlur.bind(this),this.onPollStatusCheck=this.onPollStatusCheck.bind(this),this._intervalHandle=0}get eventTarget(){return this._eventTarget}get source(){return this._sourceState}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"oninput")){let t=this.oninput;delete this.oninput,this.oninput=t}if(Object.prototype.hasOwnProperty.call(this,"onpoll")){let t=this.onpoll;delete this.onpoll,this.onpoll=t}if(Object.prototype.hasOwnProperty.call(this,"onchange")){let t=this.onchange;delete this.onchange,this.onchange=t}if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}this.hasAttribute("tabindex")||this.setAttribute("tabindex",0),this.hasAttribute("for")||this._eventTarget||this.setEventTarget(this),this._intervalHandle=setInterval(this.onPollStatusCheck,1e3)}disconnectedCallback(){this.clearEventTarget(),clearInterval(this._intervalHandle)}attributeChangedCallback(t,e,s){switch(t){case"for":this._for=s;break;case"autopoll":this._autopoll=null!==s;break;case"oninput":this.oninput=new Function("event","with(document){with(this){"+s+"}}").bind(this);break;case"onpoll":this.onpoll=new Function("event","with(document){with(this){"+s+"}}").bind(this);break;case"onchange":this.onchange=new Function("event","with(document){with(this){"+s+"}}").bind(this)}((t,e,s)=>{switch(t){case"for":{let t,e;s?(t=document.getElementById(s),e=`${t.tagName.toLowerCase()}#${s}`):(t=this,e="input-source"),this.setEventTarget(s?document.getElementById(s):this),this._titleElement.innerHTML=`for(${e})`}break;case"autopoll":this._sourceState&&(this._sourceState.autopoll=this._autopoll)}})(t,0,s)}setEventTarget(t){if(this.clearEventTarget(),t){let e=L.for(t);this._sourceState=e,this._eventTarget=t,e.autopoll=this.autopoll,e.addEventListener("poll",this.onSourcePoll),e.addEventListener("input",this.onSourceInput),t.addEventListener("focus",this.onTargetFocus),t.addEventListener("blur",this.onTargetBlur),this.dispatchEvent(new CustomEvent("change",{composed:!0,bubbles:!1}))}return this}clearEventTarget(){if(this._eventTarget){let t=this._eventTarget,e=this._sourceState;this._eventTarget=null,this._sourceState=null,t&&(t.removeEventListener("focus",this.onTargetFocus),t.removeEventListener("blur",this.onTargetBlur),e.removeEventListener("poll",this.onSourcePoll),e.removeEventListener("input",this.onSourceInput),L.delete(t))}}poll(t){this._sourceState.poll(t)}onPollStatusCheck(){this._sourceState&&this._sourceState.polling?this._pollElement.innerHTML="✓":this._pollElement.innerHTML=""}onSourceInput({stage:t,deviceName:e,keyCode:s,input:n}){this.dispatchEvent(new CustomEvent("input",{composed:!0,bubbles:!1,detail:{stage:t,deviceName:e,keyCode:s,input:n}}))}onSourcePoll({now:t}){this.dispatchEvent(new CustomEvent("poll",{composed:!0,bubbles:!1,detail:{now:t}}))}onTargetFocus(){this._focusElement.innerHTML="✓"}onTargetBlur(){this._focusElement.innerHTML=""}static get observedAttributes(){return["oninput","onpoll","onchange","for","autopoll"]}}window.customElements.define("input-source",P);class I extends HTMLElement{static get[Symbol.for("cuttleTemplate")](){let t=document.createElement("template");return t.innerHTML="<input-map>\n    <slot></slot>\n    <input-source></input-source>\n</input-map>\n",Object.defineProperty(this,Symbol.for("cuttleTemplate"),{value:t}),t}static get[Symbol.for("cuttleStyle")](){let t=document.createElement("style");return t.innerHTML=":host{display:inline-block}",Object.defineProperty(this,Symbol.for("cuttleStyle"),{value:t}),t}static get properties(){return{for:String,autopoll:Boolean,disabled:Boolean}}get disabled(){return this._disabled}set disabled(t){this.toggleAttribute("disabled",t)}get autopoll(){return this._autopoll}set autopoll(t){this.toggleAttribute("autopoll",t)}get for(){return this._for}set for(t){this.setAttribute("for",t)}static get observedAttributes(){return["for","autopoll","disabled","src"]}constructor(t=new y){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleTemplate")].content.cloneNode(!0)),this.shadowRoot.appendChild(this.constructor[Symbol.for("cuttleStyle")].cloneNode(!0)),this._src="",this._mapElement=this.shadowRoot.querySelector("input-map"),this._sourceElement=this.shadowRoot.querySelector("input-source"),this._context=t,this.onSourcePoll=this.onSourcePoll.bind(this),this.onSourceChange=this.onSourceChange.bind(this),this.onContextChange=this.onContextChange.bind(this),this._sourceElement.addEventListener("poll",this.onSourcePoll),this._sourceElement.addEventListener("change",this.onSourceChange),this._context.addEventListener("change",this.onContextChange)}get context(){return this._context}get source(){return this._sourceElement.source}get mapping(){return this._mapElement.map}get src(){return this._src}set src(t){this.setAttribute("src","string"==typeof t?t:JSON.stringify(t))}connectedCallback(){if(Object.prototype.hasOwnProperty.call(this,"for")){let t=this.for;delete this.for,this.for=t}if(Object.prototype.hasOwnProperty.call(this,"autopoll")){let t=this.autopoll;delete this.autopoll,this.autopoll=t}if(Object.prototype.hasOwnProperty.call(this,"disabled")){let t=this.disabled;delete this.disabled,this.disabled=t}!function(t,e){if(Object.prototype.hasOwnProperty.call(t,e)){let s=t[e];delete t[e],t[e]=s}}(this,"src")}attributeChangedCallback(t,e,s){switch(t){case"for":this._for=s;break;case"autopoll":this._autopoll=null!==s;break;case"disabled":this._disabled=null!==s}((t,e,s)=>{switch(t){case"for":this._sourceElement.for=s;break;case"src":if(this._src!==s)if(this._src=s,s.trim().startsWith("{")){let t=JSON.parse(s);this.updateMapping(t)}else fetch(s).then((t=>t.json())).then((t=>this.updateMapping(t)));break;case"autopoll":this._sourceElement.autopoll=this._autopoll;break;case"disabled":this._context.source&&(this._context.disabled=this._disabled)}})(t,0,s)}updateMapping(t){this._context.setInputMapping(t),this._mapElement.src=t}onSourcePoll(){for(let[t,e]of Object.entries(this._mapElement.mapElements)){let s=this._context.getInputState(t);e[0].querySelector("output").innerText=Number(s).toFixed(2)}}onSourceChange(){this._context.source&&this._context.detach(),this._sourceElement.source&&(this._context.attach(this._sourceElement.source),this._context.disabled=this._disabled)}onContextChange(){this._mapElement.src=this._context.mapping}hasInput(t){return this._context.hasInput(t)}getInput(t){return this._context.getInput(t)}getInputState(t){return this._context.getInputState(t)}getInputChanged(t){return this._context.getInputChanged(t)}}window.customElements.define("input-port",I);const A="MenuUp",N="MenuDown",H="MenuSelect";class U{constructor(t){this.gameState=t,this.index=0}tick(t){t.input.getInputChanged(A)>0&&(this.index-=1),t.input.getInputChanged(N)>0&&(this.index+=1),t.input.getInputChanged(H)>0&&this.index}update(t){}render(t){}}class R{constructor(){this.mainMenu=new U(this),this.menu=this.mainMenu}tick(t){this.menu.tick(t)}update(t){this.menu.update(t)}render(t){this.menu.render(t)}}function j(t){var e={exports:{}};return t(e,e.exports),e.exports}var K=j((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.p4D=e.p3D=e.p2D=e.lookupPairs4D=e.lookupPairs3D=e.lookupPairs2D=e.gradients4D=e.gradients3D=e.gradients2D=e.base4D=e.base3D=e.base2D=e.STRETCH_4D=e.STRETCH_3D=e.STRETCH_2D=e.SQUISH_4D=e.SQUISH_3D=e.SQUISH_2D=e.NORM_4D=e.NORM_3D=e.NORM_2D=void 0,e.NORM_2D=1/47,e.NORM_3D=1/103,e.NORM_4D=1/30,e.SQUISH_2D=(Math.sqrt(3)-1)/2,e.SQUISH_3D=(Math.sqrt(4)-1)/3,e.SQUISH_4D=(Math.sqrt(5)-1)/4,e.STRETCH_2D=(1/Math.sqrt(3)-1)/2,e.STRETCH_3D=(1/Math.sqrt(4)-1)/3,e.STRETCH_4D=(1/Math.sqrt(5)-1)/4,e.base2D=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],e.base3D=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],e.base4D=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],e.gradients2D=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],e.gradients3D=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],e.gradients4D=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],e.lookupPairs2D=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],e.lookupPairs3D=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],e.lookupPairs4D=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],e.p2D=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],e.p3D=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],e.p4D=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1]}));j((function(t,e){function s(t,e,s){return{dx:-e-t*K.SQUISH_2D,dy:-s-t*K.SQUISH_2D,xsb:e,ysb:s}}function n(t,e,s,n){return{dx:-e-t*K.SQUISH_3D,dy:-s-t*K.SQUISH_3D,dz:-n-t*K.SQUISH_3D,xsb:e,ysb:s,zsb:n}}function i(t,e,s,n,i){return{dx:-e-t*K.SQUISH_4D,dy:-s-t*K.SQUISH_4D,dz:-n-t*K.SQUISH_4D,dw:-i-t*K.SQUISH_4D,xsb:e,ysb:s,zsb:n,wsb:i}}function o(t){var e=new Uint32Array(1);return e[0]=1664525*t[0]+1013904223,e}Object.defineProperty(e,"__esModule",{value:!0}),e.makeNoise4D=e.makeNoise3D=e.makeNoise2D=void 0,e.makeNoise2D=function(t){for(var e=[],n=0;n<K.p2D.length;n+=4){for(var i=K.base2D[K.p2D[n]],r=null,a=null,l=0;l<i.length;l+=3)a=s(i[l],i[l+1],i[l+2]),null===r?e[n/4]=a:r.next=a,r=a;a.next=s(K.p2D[n+1],K.p2D[n+2],K.p2D[n+3])}var h=[];for(n=0;n<K.lookupPairs2D.length;n+=2)h[K.lookupPairs2D[n]]=e[K.lookupPairs2D[n+1]];var d=new Uint8Array(256),u=new Uint8Array(256),c=new Uint8Array(256);for(n=0;n<256;n++)c[n]=n;var p=new Uint32Array(1);for(p[0]=t,p=o(o(o(p))),n=255;n>=0;n--){p=o(p);var m=new Uint32Array(1);m[0]=(p[0]+31)%(n+1),m[0]<0&&(m[0]+=n+1),d[n]=c[m[0]],u[n]=14&d[n],c[m[0]]=c[n]}return function(t,e){for(var s=(t+e)*K.STRETCH_2D,n=t+s,i=e+s,o=Math.floor(n),r=Math.floor(i),a=(o+r)*K.SQUISH_2D,l=t-(o+a),c=e-(r+a),p=n-o,m=i-r,v=p+m,b=0,f=h[p-m+1|v<<1|v+m<<2|v+p<<4];void 0!==f;f=f.next){var g=l+f.dx,y=c+f.dy,_=2-g*g-y*y;if(_>0){var w=o+f.xsb,E=r+f.ysb,S=d[255&w],x=u[S+E&255];b+=_*_*_*_*(K.gradients2D[x]*g+K.gradients2D[x+1]*y)}}return b*K.NORM_2D}},e.makeNoise3D=function(t){for(var e=[],s=0;s<K.p3D.length;s+=9){for(var i=K.base3D[K.p3D[s]],r=null,a=null,l=0;l<i.length;l+=4)a=n(i[l],i[l+1],i[l+2],i[l+3]),null===r?e[s/9]=a:r.next=a,r=a;a.next=n(K.p3D[s+1],K.p3D[s+2],K.p3D[s+3],K.p3D[s+4]),a.next.next=n(K.p3D[s+5],K.p3D[s+6],K.p3D[s+7],K.p3D[s+8])}var h=[];for(s=0;s<K.lookupPairs3D.length;s+=2)h[K.lookupPairs3D[s]]=e[K.lookupPairs3D[s+1]];var d=new Uint8Array(256),u=new Uint8Array(256),c=new Uint8Array(256);for(s=0;s<256;s++)c[s]=s;var p=new Uint32Array(1);for(p[0]=t,p=o(o(o(p))),s=255;s>=0;s--){p=o(p);var m=new Uint32Array(1);m[0]=(p[0]+31)%(s+1),m[0]<0&&(m[0]+=s+1),d[s]=c[m[0]],u[s]=d[s]%24*3,c[m[0]]=c[s]}return function(t,e,s){for(var n=(t+e+s)*K.STRETCH_3D,i=t+n,o=e+n,r=s+n,a=Math.floor(i),l=Math.floor(o),c=Math.floor(r),p=(a+l+c)*K.SQUISH_3D,m=t-(a+p),v=e-(l+p),b=s-(c+p),f=i-a,g=o-l,y=r-c,_=f+g+y,w=0,E=h[g-y+1|f-g+1<<1|f-y+1<<2|_<<3|_+y<<5|_+g<<7|_+f<<9];void 0!==E;E=E.next){var S=m+E.dx,x=v+E.dy,D=b+E.dz,k=2-S*S-x*x-D*D;if(k>0){var M=a+E.xsb,C=l+E.ysb,T=c+E.zsb,L=d[255&M],O=d[L+C&255],P=u[O+T&255];w+=k*k*k*k*(K.gradients3D[P]*S+K.gradients3D[P+1]*x+K.gradients3D[P+2]*D)}}return w*K.NORM_3D}},e.makeNoise4D=function(t){for(var e=[],s=0;s<K.p4D.length;s+=16){for(var n=K.base4D[K.p4D[s]],r=null,a=null,l=0;l<n.length;l+=5)a=i(n[l],n[l+1],n[l+2],n[l+3],n[l+4]),null===r?e[s/16]=a:r.next=a,r=a;a.next=i(K.p4D[s+1],K.p4D[s+2],K.p4D[s+3],K.p4D[s+4],K.p4D[s+5]),a.next.next=i(K.p4D[s+6],K.p4D[s+7],K.p4D[s+8],K.p4D[s+9],K.p4D[s+10]),a.next.next.next=i(K.p4D[s+11],K.p4D[s+12],K.p4D[s+13],K.p4D[s+14],K.p4D[s+15])}var h=[];for(s=0;s<K.lookupPairs4D.length;s+=2)h[K.lookupPairs4D[s]]=e[K.lookupPairs4D[s+1]];var d=new Uint8Array(256),u=new Uint8Array(256),c=new Uint8Array(256);for(s=0;s<256;s++)c[s]=s;var p=new Uint32Array(1);for(p[0]=t,p=o(o(o(p))),s=255;s>=0;s--){p=o(p);var m=new Uint32Array(1);m[0]=(p[0]+31)%(s+1),m[0]<0&&(m[0]+=s+1),d[s]=c[m[0]],u[s]=252&d[s],c[m[0]]=c[s]}return function(t,e,s,n){for(var i=(t+e+s+n)*K.STRETCH_4D,o=t+i,r=e+i,a=s+i,l=n+i,c=Math.floor(o),p=Math.floor(r),m=Math.floor(a),v=Math.floor(l),b=(c+p+m+v)*K.SQUISH_4D,f=t-(c+b),g=e-(p+b),y=s-(m+b),_=n-(v+b),w=o-c,E=r-p,S=a-m,x=l-v,D=w+E+S+x,k=0,M=h[S-x+1|E-S+1<<1|E-x+1<<2|w-E+1<<3|w-S+1<<4|w-x+1<<5|D<<6|D+x<<8|D+S<<11|D+E<<14|D+w<<17];void 0!==M;M=M.next){var C=f+M.dx,T=g+M.dy,L=y+M.dz,O=_+M.dw,P=2-C*C-T*T-L*L-O*O;if(P>0){var I=c+M.xsb,A=p+M.ysb,N=m+M.zsb,H=v+M.wsb,U=d[255&I],R=d[U+A&255],j=d[R+N&255],F=u[j+H&255];k+=P*P*P*P*(K.gradients4D[F]*C+K.gradients4D[F+1]*T+K.gradients4D[F+2]*L+K.gradients4D[F+3]*O)}}return k*K.NORM_4D}}})),window.addEventListener("DOMContentLoaded",(async function(){const t=document.querySelector("#main");t.width=320,t.height=240;const e=document.querySelector("input-context");e.src=F,e.source.autopoll=!1;let s={started:!1,running:!1,display:t,input:e,frames:0,tickTime:0,ticks:0};s.running=!0,t.addEventListener("frame",(t=>{if(s.running)if(s.started){const e=t.detail.deltaTime;for(s.tickTime+=e;s.tickTime>=0;)s.tickTime-=1,q(s);!function(t){t.currentState.update(t)}(s),function(t){++t.frames,t.currentState.render(t)}(s)}else s.started=!0,function(t){let e=new R;t.mainMenu=e,t.currentState=e}(s);else s.started&&(s.started=!1)}))}));const F={MoveLeft:["Keyboard:ArrowLeft","Keyboard:KeyA"],MoveRight:["Keyboard:ArrowRight","Keyboard:KeyD"],MoveUp:["Keyboard:ArrowUp","Keyboard:KeyW"],MoveDown:["Keyboard:ArrowDown","Keyboard:KeyS"],Evade:{key:"Keyboard:Space",event:"down"},Interact:{key:"Keyboard:KeyE",event:"down"},Interacting:"Keyboard:KeyE"};function q(t){++t.ticks,t.input.source.poll(),t.currentState.tick(t)}}();
